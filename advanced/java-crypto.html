<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Java у╝ќуаЂтњїтіат»є | JAVACORE</title>
    <meta name="description" content="Java ТЋЎуеІ">
    <meta name="generator" content="VuePress 1.3.1">
    <link rel="icon" href="/javacore/favicon.ico">
    
    <link rel="preload" href="/javacore/assets/css/0.styles.e9d65cce.css" as="style"><link rel="preload" href="/javacore/assets/js/app.3de50782.js" as="script"><link rel="preload" href="/javacore/assets/js/4.13456b84.js" as="script"><link rel="preload" href="/javacore/assets/js/11.350d5fe0.js" as="script"><link rel="preload" href="/javacore/assets/js/5.65836544.js" as="script"><link rel="prefetch" href="/javacore/assets/js/10.8c899971.js"><link rel="prefetch" href="/javacore/assets/js/12.2199728e.js"><link rel="prefetch" href="/javacore/assets/js/13.967fce6c.js"><link rel="prefetch" href="/javacore/assets/js/14.8275d0bd.js"><link rel="prefetch" href="/javacore/assets/js/15.6a09a144.js"><link rel="prefetch" href="/javacore/assets/js/16.19f02ba1.js"><link rel="prefetch" href="/javacore/assets/js/17.ed1ae7cf.js"><link rel="prefetch" href="/javacore/assets/js/18.9542df9d.js"><link rel="prefetch" href="/javacore/assets/js/19.33815bc9.js"><link rel="prefetch" href="/javacore/assets/js/20.b48a1605.js"><link rel="prefetch" href="/javacore/assets/js/21.84842e19.js"><link rel="prefetch" href="/javacore/assets/js/22.9856136d.js"><link rel="prefetch" href="/javacore/assets/js/23.078a7e69.js"><link rel="prefetch" href="/javacore/assets/js/24.8961f549.js"><link rel="prefetch" href="/javacore/assets/js/25.f5d70f7e.js"><link rel="prefetch" href="/javacore/assets/js/26.adedecef.js"><link rel="prefetch" href="/javacore/assets/js/27.f475d82e.js"><link rel="prefetch" href="/javacore/assets/js/28.3f8ad064.js"><link rel="prefetch" href="/javacore/assets/js/29.b5314d44.js"><link rel="prefetch" href="/javacore/assets/js/30.f0531d6e.js"><link rel="prefetch" href="/javacore/assets/js/31.11f77e70.js"><link rel="prefetch" href="/javacore/assets/js/32.2048c2de.js"><link rel="prefetch" href="/javacore/assets/js/33.ac464a7a.js"><link rel="prefetch" href="/javacore/assets/js/34.41b97081.js"><link rel="prefetch" href="/javacore/assets/js/35.95494b37.js"><link rel="prefetch" href="/javacore/assets/js/36.9eaef114.js"><link rel="prefetch" href="/javacore/assets/js/37.3b4e6b6f.js"><link rel="prefetch" href="/javacore/assets/js/38.8599d9b0.js"><link rel="prefetch" href="/javacore/assets/js/39.143cacbc.js"><link rel="prefetch" href="/javacore/assets/js/40.d1838ae1.js"><link rel="prefetch" href="/javacore/assets/js/41.2fa20809.js"><link rel="prefetch" href="/javacore/assets/js/42.59c1ab82.js"><link rel="prefetch" href="/javacore/assets/js/43.7ef1889c.js"><link rel="prefetch" href="/javacore/assets/js/44.b0f638dd.js"><link rel="prefetch" href="/javacore/assets/js/45.7b50418b.js"><link rel="prefetch" href="/javacore/assets/js/46.e4d1c39f.js"><link rel="prefetch" href="/javacore/assets/js/47.b7cfbd0c.js"><link rel="prefetch" href="/javacore/assets/js/48.e661dc3b.js"><link rel="prefetch" href="/javacore/assets/js/49.8783fd36.js"><link rel="prefetch" href="/javacore/assets/js/50.885a9acc.js"><link rel="prefetch" href="/javacore/assets/js/51.202cb367.js"><link rel="prefetch" href="/javacore/assets/js/52.53409cde.js"><link rel="prefetch" href="/javacore/assets/js/53.400a404c.js"><link rel="prefetch" href="/javacore/assets/js/54.5410b72b.js"><link rel="prefetch" href="/javacore/assets/js/55.c904afaa.js"><link rel="prefetch" href="/javacore/assets/js/56.2b2538de.js"><link rel="prefetch" href="/javacore/assets/js/57.cae5cfaf.js"><link rel="prefetch" href="/javacore/assets/js/58.3a2e559c.js"><link rel="prefetch" href="/javacore/assets/js/59.2464138f.js"><link rel="prefetch" href="/javacore/assets/js/6.76e266d6.js"><link rel="prefetch" href="/javacore/assets/js/60.7dc4947f.js"><link rel="prefetch" href="/javacore/assets/js/61.4da8e90f.js"><link rel="prefetch" href="/javacore/assets/js/62.6c617e5b.js"><link rel="prefetch" href="/javacore/assets/js/7.477def74.js"><link rel="prefetch" href="/javacore/assets/js/8.7e86464c.js"><link rel="prefetch" href="/javacore/assets/js/9.9c34e164.js"><link rel="prefetch" href="/javacore/assets/js/vendors~flowchart.184dd07e.js"><link rel="prefetch" href="/javacore/assets/js/vendors~notification.de05f6a9.js">
    <link rel="stylesheet" href="/javacore/assets/css/0.styles.e9d65cce.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/javacore/" class="home-link router-link-active"><img src="images/dunwu-logo-100.png" alt="JAVACORE" class="logo"> <span class="site-name can-hide">JAVACORE</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/javacore/basics/" class="nav-link">
  тЪ║уАђ
</a></div><div class="nav-item"><a href="/javacore/advanced/" class="nav-link router-link-active">
  жФўу║Д
</a></div><div class="nav-item"><a href="/javacore/container/" class="nav-link">
  т«╣тЎе
</a></div><div class="nav-item"><a href="/javacore/io/" class="nav-link">
  IO
</a></div><div class="nav-item"><a href="/javacore/concurrent/" class="nav-link">
  т╣ХтЈЉ
</a></div><div class="nav-item"><a href="/javacore/jvm/" class="nav-link">
  JVM
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">Рюе Javaу│╗тѕЌ</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/java-tutorial/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Java ТЋЎуеІ ­ЪЊџ
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/javacore/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  JavaCore ТЋЎуеІ ­ЪЊџ
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/javacore/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  JavaTech ТЋЎуеІ ­ЪЊџ
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/spring-tutorial/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Spring ТЋЎуеІ ­ЪЊџ
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/spring-boot-tutorial/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Spring Boot ТЋЎуеІ ­ЪЊџ
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><a href="https://github.com/dunwu/blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ­Ъј» тЇџт«б
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/dunwu/javacore" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/javacore/basics/" class="nav-link">
  тЪ║уАђ
</a></div><div class="nav-item"><a href="/javacore/advanced/" class="nav-link router-link-active">
  жФўу║Д
</a></div><div class="nav-item"><a href="/javacore/container/" class="nav-link">
  т«╣тЎе
</a></div><div class="nav-item"><a href="/javacore/io/" class="nav-link">
  IO
</a></div><div class="nav-item"><a href="/javacore/concurrent/" class="nav-link">
  т╣ХтЈЉ
</a></div><div class="nav-item"><a href="/javacore/jvm/" class="nav-link">
  JVM
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">Рюе Javaу│╗тѕЌ</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/java-tutorial/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Java ТЋЎуеІ ­ЪЊџ
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/javacore/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  JavaCore ТЋЎуеІ ­ЪЊџ
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/javacore/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  JavaTech ТЋЎуеІ ­ЪЊџ
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/spring-tutorial/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Spring ТЋЎуеІ ­ЪЊџ
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/spring-boot-tutorial/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Spring Boot ТЋЎуеІ ­ЪЊџ
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><a href="https://github.com/dunwu/blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ­Ъј» тЇџт«б
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/dunwu/javacore" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Java у╝ќуаЂтњїтіат»є</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/javacore/advanced/java-crypto.html#Тю»У»Г" class="sidebar-link">Тю»У»Г</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/javacore/advanced/java-crypto.html#base64-у╝ќуаЂ" class="sidebar-link">Base64 у╝ќуаЂ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/javacore/advanced/java-crypto.html#у«ЌТ│Ћу«ђУ┐░" class="sidebar-link">у«ЌТ│Ћу«ђУ┐░</a></li><li class="sidebar-sub-header"><a href="/javacore/advanced/java-crypto.html#у«ЌТ│Ћт«ъуј░" class="sidebar-link">у«ЌТ│Ћт«ъуј░</a></li></ul></li><li><a href="/javacore/advanced/java-crypto.html#т»╣уД░тіат»є" class="sidebar-link">т»╣уД░тіат»є</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/javacore/advanced/java-crypto.html#у«ЌТ│Ћу«ђУ┐░-2" class="sidebar-link">у«ЌТ│Ћу«ђУ┐░</a></li><li class="sidebar-sub-header"><a href="/javacore/advanced/java-crypto.html#у«ЌТ│Ћт«ъуј░-2" class="sidebar-link">у«ЌТ│Ћт«ъуј░</a></li></ul></li><li><a href="/javacore/advanced/java-crypto.html#жЮът»╣уД░тіат»є" class="sidebar-link">жЮът»╣уД░тіат»є</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/javacore/advanced/java-crypto.html#у«ЌТ│Ћу«ђУ┐░-3" class="sidebar-link">у«ЌТ│Ћу«ђУ┐░</a></li><li class="sidebar-sub-header"><a href="/javacore/advanced/java-crypto.html#у«ЌТ│Ћт«ъуј░-3" class="sidebar-link">у«ЌТ│Ћт«ъуј░</a></li></ul></li><li><a href="/javacore/advanced/java-crypto.html#ТХѕТЂ»ТЉўУдЂ" class="sidebar-link">ТХѕТЂ»ТЉўУдЂ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/javacore/advanced/java-crypto.html#у«ЌТ│Ћу«ђУ┐░-4" class="sidebar-link">у«ЌТ│Ћу«ђУ┐░</a></li><li class="sidebar-sub-header"><a href="/javacore/advanced/java-crypto.html#у«ЌТ│Ћт«ъуј░-4" class="sidebar-link">у«ЌТ│Ћт«ъуј░</a></li></ul></li><li><a href="/javacore/advanced/java-crypto.html#ТЋ░тГЌуГЙтљЇ" class="sidebar-link">ТЋ░тГЌуГЙтљЇ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/javacore/advanced/java-crypto.html#у«ЌТ│Ћу«ђУ┐░-5" class="sidebar-link">у«ЌТ│Ћу«ђУ┐░</a></li><li class="sidebar-sub-header"><a href="/javacore/advanced/java-crypto.html#у«ЌТ│Ћт«ъуј░-5" class="sidebar-link">у«ЌТ│Ћт«ъуј░</a></li></ul></li><li><a href="/javacore/advanced/java-crypto.html#тЈѓУђЃУхёТќЎ" class="sidebar-link">тЈѓУђЃУхёТќЎ</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="java-у╝ќуаЂтњїтіат»є"><a href="#java-у╝ќуаЂтњїтіат»є" class="header-anchor">#</a> Java у╝ќуаЂтњїтіат»є</h1> <blockquote><p><strong>­ЪЊд ТюгТќЄС╗ЦтЈіуц║СЙІТ║љуаЂти▓тйњТАБтюе <a href="https://github.com/dunwu/javacore/" target="_blank" rel="noopener noreferrer">javacore<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></strong></p></blockquote> <h2 id="Тю»У»Г"><a href="#Тю»У»Г" class="header-anchor">#</a> Тю»У»Г</h2> <ul><li><strong>ТўјТќЄ(Plaintext)</strong>№╝џТїЄтЙЁтіат»єС┐АТЂ»сђѓТўјТќЄтЈ»С╗ЦТў»ТќЄТюгТќЄС╗ХсђЂтЏЙуЅЄТќЄС╗ХсђЂС║їУ┐ЏтѕХТЋ░ТЇ«уГЅсђѓ</li> <li><strong>т»єТќЄ(Ciphertext)</strong>№╝џТїЄу╗ЈУ┐Єтіат»єтљјуџёТўјТќЄсђѓт»єТќЄжђџтИИС╗ЦТќЄТюгсђЂС║їУ┐ЏтѕХуГЅтйбт╝ЈтГўтюесђѓ</li> <li><strong>тіат»є(Encryption)</strong>№╝џТїЄт░єТўјТќЄУйгТЇбСИ║т»єТќЄуџёУ┐ЄуеІсђѓ</li> <li><strong>УДБт»є(Decryption)</strong>№╝џТїЄт░єт»єТќЄУйгТЇбСИ║ТўјТќЄуџёУ┐ЄуеІсђѓ</li> <li><strong>тіат»єт»єжњЦ(Encryption Key)</strong>№╝џТїЄжђџУ┐Єтіат»єу«ЌТ│ЋУ┐ЏУАїтіат»єТЊЇСйюућеуџёт»єжњЦсђѓ</li> <li><strong>УДБт»єт»єжњЦ(Decryption Key)</strong>№╝џТїЄжђџУ┐ЄУДБт»єу«ЌТ│ЋУ┐ЏУАїУДБт»єТЊЇСйюућеуџёт»єжњЦсђѓ</li> <li><strong>С┐АжЂЊ(Channel)</strong>№╝џжђџС┐АуџёжђџжЂЊ№╝їТў»С┐АтЈиС╝аУЙЊуџётфњС╗Ісђѓ</li></ul> <h2 id="base64-у╝ќуаЂ"><a href="#base64-у╝ќуаЂ" class="header-anchor">#</a> Base64 у╝ќуаЂ</h2> <h3 id="у«ЌТ│Ћу«ђУ┐░"><a href="#у«ЌТ│Ћу«ђУ┐░" class="header-anchor">#</a> у«ЌТ│Ћу«ђУ┐░</h3> <h4 id="т«џС╣Ѕ"><a href="#т«џС╣Ѕ" class="header-anchor">#</a> т«џС╣Ѕ</h4> <p>Base64 тєЁт«╣С╝ажђЂу╝ќуаЂТў»СИђуДЇС╗ЦС╗╗ТёЈ 8 СйЇтГЌУіѓт║ЈтѕЌу╗ётљѕуџёТЈЈУ┐░тйбт╝Ј№╝їУ┐ЎуДЇтйбт╝ЈСИЇТўЊУбФС║║уЏ┤ТјЦУ»єтѕФсђѓ</p> <p>Base64 Тў»СИђуДЇтЙѕтИИУДЂуџёу╝ќуаЂУДёУїЃ№╝їтЁХСйюућеТў»т░єС║їУ┐ЏтѕХт║ЈтѕЌУйгТЇбСИ║С║║у▒╗тЈ»У»╗уџё ASCII тГЌугдт║ЈтѕЌ№╝їтИИућетюежюђућежђџУ┐ЄТќЄТюгтЇЈУ««№╝ѕТ»ћтдѓ HTTP тњї SMTP№╝ЅТЮЦС╝аУЙЊС║їУ┐ЏтѕХТЋ░ТЇ«уџёТЃЁтєхСИІсђѓ<strong>Base64 т╣ХСИЇТў»тіат»єУДБт»єу«ЌТ│Ћ</strong>№╝їт░йу«АТѕЉС╗гТюЅТЌХС╣Ътљгтѕ░Сй┐уће Base64 ТЮЦтіат»єУДБт»єуџёУ»┤Т│Ћ№╝їСйєУ┐ЎжЄїТЅђУ»┤уџётіат»єСИјУДБт»єт«ъжЎЁТў»ТїЄ**у╝ќуаЂ№╝ѕencode№╝Ѕ<strong>тњї</strong>УДБуаЂ№╝ѕdecode№╝Ѕ**уџёУ┐ЄуеІ№╝їтЁХтЈўТЇбТў»жЮътИИу«ђтЇЋуџё№╝їС╗ЁС╗ЁУЃйтцЪжЂ┐тЁЇС┐АТЂ»УбФуЏ┤ТјЦУ»єтѕФсђѓ</p> <h4 id="тјЪуљє"><a href="#тјЪуљє" class="header-anchor">#</a> тјЪуљє</h4> <p>Base64 у«ЌТ│ЋСИ╗УдЂТў»т░єу╗Ўт«џуџётГЌугдС╗ЦтГЌугду╝ќуаЂ(тдѓ ASCII уаЂ№╝їUTF-8 уаЂ)т»╣т║ћуџётЇЂУ┐ЏтѕХТЋ░СИ║тЪ║тЄє№╝їтЂџу╝ќуаЂТЊЇСйю№╝џ</p> <ol><li>т░єу╗Ўт«џуџётГЌугдСИ▓С╗ЦтГЌугдСИ║тЇЋСйЇ№╝їУйгТЇбСИ║т»╣т║ћуџётГЌугду╝ќуаЂсђѓ</li> <li>т░єУјитЙЌтГЌугду╝ќуаЂУйгТЇбСИ║С║їУ┐ЏтѕХ</li> <li>т»╣С║їУ┐ЏтѕХуаЂтЂџтѕєу╗ёУйгТЇб№╝їТ»Ј 3 СИфтГЌУіѓСИ║СИђу╗ё№╝їУйгТЇбСИ║Т»Ј 4 СИф 6 СйЇС║їУ┐ЏтѕХСйЇСИђу╗ё№╝ѕСИЇУХ│ 6 СйЇТЌХСйјСйЇУАЦ 0№╝ЅсђѓУ┐ЎТў»СИђСИфтѕєу╗ётЈўтїќуџёУ┐ЄуеІ№╝ї3 СИф 8 СйЇС║їУ┐ЏтѕХуаЂтњї 4 СИф 6 СйЇС║їУ┐ЏтѕХуаЂуџёжЋ┐т║джЃйТў» 24 СйЇ№╝ѕ3<em>8 = 4</em>6 = 24№╝Ѕсђѓ</li> <li>т»╣УјитЙЌуџё 4-6 С║їУ┐ЏтѕХуаЂУАЦСйЇ№╝їтљЉ 6 СйЇС║їУ┐ЏтѕХуаЂТи╗тіа 2 СйЇжФўСйЇ 0№╝їу╗ёТѕљ 4 СИф 8 СйЇС║їУ┐ЏтѕХуаЂсђѓ</li> <li>т»╣УјитЙЌуџё 4-8 С║їУ┐ЏтѕХуаЂУйгТЇбСИ║тЇЂУ┐ЏтѕХуаЂсђѓ</li> <li>т░єУјитЙЌуџётЇЂУ┐ЏтѕХуаЂУйгТЇбСИ║ Base64 тГЌугдУАеСИГт»╣т║ћуџётГЌугдсђѓ</li></ol> <p><em><strong>Base64 у╝ќуаЂУАе</strong></em></p> <table><thead><tr><th><strong>у┤бт╝Ћ</strong></th> <th><strong>т»╣т║ћтГЌугд</strong></th> <th><strong>у┤бт╝Ћ</strong></th> <th><strong>т»╣т║ћтГЌугд</strong></th> <th><strong>у┤бт╝Ћ</strong></th> <th><strong>т»╣т║ћтГЌугд</strong></th> <th><strong>у┤бт╝Ћ</strong></th> <th><strong>т»╣т║ћтГЌугд</strong></th></tr></thead> <tbody><tr><td>0</td> <td>A</td> <td>17</td> <td>R</td> <td>34</td> <td>i</td> <td>51</td> <td>z</td></tr> <tr><td>1</td> <td>B</td> <td>18</td> <td>S</td> <td>35</td> <td>j</td> <td>52</td> <td>0</td></tr> <tr><td>2</td> <td>C</td> <td>19</td> <td>T</td> <td>36</td> <td>k</td> <td>53</td> <td>1</td></tr> <tr><td>3</td> <td>D</td> <td>20</td> <td>U</td> <td>37</td> <td>l</td> <td>54</td> <td>2</td></tr> <tr><td>4</td> <td>E</td> <td>21</td> <td>V</td> <td>38</td> <td>m</td> <td>55</td> <td>3</td></tr> <tr><td>5</td> <td>F</td> <td>22</td> <td>W</td> <td>39</td> <td>n</td> <td>56</td> <td>4</td></tr> <tr><td>6</td> <td>G</td> <td>23</td> <td>X</td> <td>40</td> <td>o</td> <td>57</td> <td>5</td></tr> <tr><td>7</td> <td>H</td> <td>24</td> <td>Y</td> <td>41</td> <td>p</td> <td>58</td> <td>6</td></tr> <tr><td>8</td> <td>I</td> <td>25</td> <td>Z</td> <td>42</td> <td>q</td> <td>59</td> <td>7</td></tr> <tr><td>9</td> <td>J</td> <td>26</td> <td>a</td> <td>43</td> <td>r</td> <td>60</td> <td>8</td></tr> <tr><td>10</td> <td>K</td> <td>27</td> <td>b</td> <td>44</td> <td>s</td> <td>61</td> <td>9</td></tr> <tr><td>11</td> <td>L</td> <td>28</td> <td>c</td> <td>45</td> <td>t</td> <td>62</td> <td>+</td></tr> <tr><td>12</td> <td>M</td> <td>29</td> <td>d</td> <td>46</td> <td>u</td> <td>63</td> <td>/</td></tr> <tr><td>13</td> <td>N</td> <td>30</td> <td>e</td> <td>47</td> <td>v</td> <td></td> <td></td></tr> <tr><td>14</td> <td>O</td> <td>31</td> <td>f</td> <td>48</td> <td>w</td> <td></td> <td></td></tr> <tr><td>15</td> <td>P</td> <td>32</td> <td>g</td> <td>49</td> <td>x</td> <td></td> <td></td></tr> <tr><td>16</td> <td>Q</td> <td>33</td> <td>h</td> <td>50</td> <td>y</td> <td></td> <td></td></tr></tbody></table> <h4 id="т║ћуће"><a href="#т║ћуће" class="header-anchor">#</a> т║ћуће</h4> <p>Base64 у╝ќуаЂтЈ»ућеС║јтюе HTTP уј»тбЃСИІС╝ажђњУЙЃжЋ┐уџёТаЄУ»єС┐АТЂ»сђѓтюетЁХС╗ќт║ћућеуеІт║ЈСИГ№╝їС╣ЪтИИтИИжюђУдЂТііС║їУ┐ЏтѕХТЋ░ТЇ«у╝ќуаЂСИ║жђѓтљѕТћЙтюе URL(тїЁТІгжџљУЌЈУАетЇЋтЪЪ)СИГуџётйбт╝ЈсђѓТГцТЌХ№╝їжЄЄуће Base64 у╝ќуаЂтЁиТюЅСИЇтЈ»У»╗ТђД№╝їтЇ│ТЅђу╝ќуаЂуџёТЋ░ТЇ«СИЇС╝џУбФС║║ућеУѓЅую╝ТЅђуЏ┤ТјЦуюІтѕ░№╝їу«ЌТў»Ухитѕ░СИђСИфтіат»єуџёСйюућесђѓ</p> <p>уёХУђї№╝ї<strong>ТаЄтЄєуџё Base64 т╣ХСИЇжђѓтљѕуЏ┤ТјЦТћЙтюе URL жЄїС╝аУЙЊ</strong>№╝їтЏаСИ║ URL у╝ќуаЂтЎеС╝џТііТаЄтЄє Base64 СИГуџё <code>/</code> тњї <code>+</code> тГЌугдтЈўСИ║тйбтдѓ <code>%XX</code> уџётйбт╝Ј№╝їУђїУ┐ЎС║Џ <code>%</code> тЈитюетГўтЁЦТЋ░ТЇ«т║ЊТЌХУ┐ўжюђУдЂтєЇУ┐ЏУАїУйгТЇб№╝їтЏаСИ║ ANSI SQL СИГти▓т░є <code>%</code> тЈиућеСйюжђџжЁЇугдсђѓ</p> <p>СИ║УДБтє│ТГцжЌ«жбў№╝їтЈ»жЄЄућеСИђуДЇућеС║ј URL уџёТћ╣У┐Џ Base64 у╝ќуаЂ№╝їт«ЃСИЇС╗ЁтюеТюФт░ЙтАФтЁЁ <code>=</code> тЈи№╝їт╣Хт░єТаЄтЄє Base64 СИГуџёРђю+РђЮтњїРђю/РђЮтѕєтѕФТћ╣ТѕљС║є <code>-</code> тњї <code>_</code>№╝їУ┐ЎТаит░▒тЁЇтј╗С║єтюе URL у╝ќУДБуаЂтњїТЋ░ТЇ«т║ЊтГўтѓеТЌХТЅђУдЂСйюуџёУйгТЇб№╝їжЂ┐тЁЇС║єу╝ќуаЂС┐АТЂ»жЋ┐т║дтюеТГцУ┐ЄуеІСИГуџётбътіа№╝їт╣Ху╗ЪСИђС║єТЋ░ТЇ«т║ЊсђЂУАетЇЋуГЅтцёт»╣У▒АТаЄУ»єугдуџёТа╝т╝Јсђѓ</p> <p>тЈдТюЅСИђуДЇућеС║јТГБтѕЎУАеУЙЙт╝ЈуџёТћ╣У┐Џ Base64 тЈўуДЇ№╝їт«Ѓт░є <code>+</code> тњї <code>/</code> Тћ╣ТѕљС║є <code>!</code> тњї <code>-</code>№╝їтЏаСИ║ <code>+</code>, <code>*</code> С╗ЦтЈітЅЇжЮбтюе IRCu СИГућетѕ░уџё <code>[</code> тњї <code>]</code> тюеТГБтѕЎУАеУЙЙт╝ЈСИГжЃйтЈ»УЃйтЁиТюЅуЅ╣Т«ітљФС╣Ѕсђѓ</p> <h3 id="у«ЌТ│Ћт«ъуј░"><a href="#у«ЌТ│Ћт«ъуј░" class="header-anchor">#</a> у«ЌТ│Ћт«ъуј░</h3> <p><code>commons-codec</code>т╝ђТ║љтїЁТЈљСЙЏС║єт»╣С║ј Base64 уџёт«ъуј░№╝їТјеУЇљСй┐ућесђѓ</p> <p>У»итюе maven тиЦуеІСИГТи╗тіаСЙЮУхќ№╝џ</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>commons-codec<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>commons-codec<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.10<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><em><strong>УїЃСЙІ</strong></em></p> <p>Т│е№╝џтюе commons-codec тїЁСИГуџё Base64 У┐ЎСИфу▒╗СИГТЈљСЙЏС║є Base64 уџёу╝ќуаЂсђЂУДБуаЂТќ╣т╝Јсђѓ</p> <p>тЁХСИГ№╝ї<code>encodeBase64</code>ТЈљСЙЏуџёТў»ТаЄтЄєуџё Base64 у╝ќуаЂТќ╣т╝Ј№╝Џ<code>encodeBase64URLSafe</code>ТЈљСЙЏС║є URL т«ЅтЁеуџё Base64 у╝ќуаЂТќ╣т╝Ј№╝ѕт░є+ тњї /ТЏ┐ТЇбСИ║ - тњї _№╝Ѕсђѓ</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">org<span class="token punctuation">.</span>zp<span class="token punctuation">.</span>javase<span class="token punctuation">.</span>security<span class="token punctuation">.</span>encrypt</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>codec<span class="token punctuation">.</span>binary</span><span class="token punctuation">.</span><span class="token class-name">Base64</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io</span><span class="token punctuation">.</span><span class="token class-name">UnsupportedEncodingException</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Base64Demo</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">UnsupportedEncodingException</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> url <span class="token operator">=</span> <span class="token string">&quot;https://www.baidu.com/s?wd=Base64&amp;rsv_spt=1&amp;rsv_iqid=0xa9188d560005131f&amp;issp=1&amp;f=3&amp;rsv_bp=0&amp;rsv_idx=2&amp;ie=utf-8&amp;tn=baiduhome_pg&amp;rsv_enter=1&amp;rsv_sug3=1&amp;rsv_sug1=1&amp;rsv_sug7=001&amp;rsv_sug2=1&amp;rsp=0&amp;rsv_sug9=es_2_1&amp;rsv_sug4=2153&amp;rsv_sug=9&quot;</span><span class="token punctuation">;</span>
        <span class="token comment">// byte[] encoded = Base64.encodeBase64(url.getBytes(&quot;UTF8&quot;)); // ТаЄтЄєуџёBase64у╝ќуаЂ</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> encoded <span class="token operator">=</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">encodeBase64URLSafe</span><span class="token punctuation">(</span>url<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token string">&quot;UTF8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// URLт«ЅтЁеуџёBase64у╝ќуаЂ</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> decoded <span class="token operator">=</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">decodeBase64</span><span class="token punctuation">(</span>encoded<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;url:&quot;</span> <span class="token operator">+</span> url<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;encoded:&quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>encoded<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;decoded:&quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>decoded<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="т»╣уД░тіат»є"><a href="#т»╣уД░тіат»є" class="header-anchor">#</a> т»╣уД░тіат»є</h2> <h3 id="у«ЌТ│Ћу«ђУ┐░-2"><a href="#у«ЌТ│Ћу«ђУ┐░-2" class="header-anchor">#</a> у«ЌТ│Ћу«ђУ┐░</h3> <p>т»╣уД░тіат»єу«ЌТ│ЋТў»т║ћућеУЙЃТЌЕуџётіат»єу«ЌТ│Ћ№╝їТіђТю»ТѕљуєЪсђѓтюет»╣уД░тіат»єу«ЌТ│ЋСИГ№╝їТЋ░ТЇ«тЈЉС┐АТќ╣т░єТўјТќЄ№╝ѕтјЪтДІТЋ░ТЇ«№╝Ѕтњїтіат»єт»єжњЦ№╝ѕmi yao№╝ЅСИђУхиу╗ЈУ┐ЄуЅ╣Т«ітіат»єу«ЌТ│Ћтцёуљєтљј№╝їСй┐тЁХтЈўТѕљтцЇТЮѓуџётіат»єт»єТќЄтЈЉжђЂтЄ║тј╗сђѓТћХС┐АТќ╣ТћХтѕ░т»єТќЄтљј№╝їУІЦТЃ│УДБУ»╗тјЪТќЄ№╝їтѕЎжюђУдЂСй┐ућетіат»єућеУ┐Єуџёт»єжњЦтЈіуЏИтљїу«ЌТ│Ћуџёжђєу«ЌТ│Ћт»╣т»єТќЄУ┐ЏУАїУДБт»є№╝їТЅЇУЃйСй┐тЁХТЂбтцЇТѕљтЈ»У»╗ТўјТќЄсђѓтюет»╣уД░тіат»єу«ЌТ│ЋСИГ№╝їСй┐ућеуџёт»єжњЦтЈфТюЅСИђСИф№╝їтЈЉТћХС┐АтЈїТќ╣жЃйСй┐ућеУ┐ЎСИфт»єжњЦт»╣ТЋ░ТЇ«У┐ЏУАїтіат»єтњїУДБт»є№╝їУ┐Ўт░▒УдЂТ▒ѓУДБт»єТќ╣С║ІтЁѕт┐ЁжА╗уЪЦжЂЊтіат»єт»єжњЦсђѓ</p> <h4 id="уЅ╣уѓ╣"><a href="#уЅ╣уѓ╣" class="header-anchor">#</a> уЅ╣уѓ╣</h4> <h5 id="С╝ўуѓ╣№╝џ"><a href="#С╝ўуѓ╣№╝џ" class="header-anchor">#</a> С╝ўуѓ╣№╝џ</h5> <p>У«Ау«ЌжЄЈт░ЈсђЂтіат»єжђЪт║дт┐ФсђЂтіат»єТЋѕујЄжФўсђѓ</p> <h5 id="у╝║уѓ╣№╝џ"><a href="#у╝║уѓ╣№╝џ" class="header-anchor">#</a> у╝║уѓ╣№╝џ</h5> <p>у«ЌТ│ЋТў»тЁгт╝ђуџё№╝їт«ЅтЁеТђДтЙЌСИЇтѕ░С┐ЮУ»Ђсђѓ</p> <p>жђџС┐АтЈїТќ╣Т»ЈТгАСй┐ућет»╣уД░тіат»єу«ЌТ│ЋТЌХ№╝їжЃйжюђУдЂСй┐ућетЁХС╗ќС║║СИЇуЪЦжЂЊуџёТЃЪСИђт»єжњЦ№╝їУ┐ЎС╝џСй┐тЙЌжђџС┐АтЈїТќ╣ТЅђТІЦТюЅуџёт»єжњЦТЋ░жЄЈтЉѕтЄаСйЋу║ДТЋ░тбъжЋ┐№╝їт»єжњЦу«АуљєТѕљСИ║ућеТѕиуџёУ┤ЪТІЁсђѓт»╣уД░тіат»єу«ЌТ│ЋтюетѕєтИЃт╝ЈуйЉу╗юу│╗у╗ЪСИіСй┐ућеУЙЃСИ║тЏ░жџЙ№╝їСИ╗УдЂТў»тЏаСИ║т»єжњЦу«АуљєтЏ░жџЙ№╝їСй┐ућеТѕљТюгУЙЃжФўсђѓ</p> <p>УђїСИјтЁгжњЦсђЂт»єжњЦтіат»єу«ЌТ│ЋТ»ћУхиТЮЦ№╝їт»╣уД░тіат»єу«ЌТ│ЋУЃйтцЪТЈљСЙЏтіат»єтњїУ«цУ»ЂтЇ┤у╝║С╣ЈС║єуГЙтљЇтіЪУЃй№╝їСй┐тЙЌСй┐ућеУїЃтЏ┤ТюЅТЅђу╝Ет░Јсђѓ</p> <h4 id="тјЪуљє-2"><a href="#тјЪуљє-2" class="header-anchor">#</a> тјЪуљє</h4> <p>т»╣уД░тіат»єУдЂТ▒ѓтіат»єСИјУДБт»єСй┐ућетљїСИђСИфт»єжњЦ№╝їУДБт»єТў»тіат»єуџёжђєУ┐љу«Ќсђѓућ▒С║јтіат»єсђЂУДБт»єСй┐ућетљїСИђСИфт»єжњЦ№╝їУ┐ЎУдЂТ▒ѓжђџС┐АтЈїТќ╣т┐ЁжА╗тюежђџС┐АтЅЇтЋєт«џУ»Цт»єжњЦ№╝їт╣ХтдЦтќёС┐ЮтГўУ»Цт»єжњЦсђѓ</p> <p>т»╣уД░тіат»єСйЊтѕХтѕєСИ║СИцуДЇ№╝џ</p> <p>СИђуДЇТў»т»╣ТўјТќЄуџётЇЋСИфСйЇ№╝ѕТѕќтГЌУіѓ№╝ЅУ┐ЏУАїУ┐љу«Ќ№╝їуД░СИ║ТхЂт»єуаЂ№╝їС╣ЪуД░СИ║т║ЈтѕЌт»єуаЂ№╝Џ</p> <p>СИђуДЇТў»ТііТўјТќЄС┐АТЂ»тѕњтѕєСИ║СИЇтљїуџёу╗ё№╝ѕТѕќтЮЌ№╝Ѕу╗ЊТъё№╝їтѕєтѕФт»╣Т»ЈСИфу╗ё№╝ѕТѕќтЮЌ№╝ЅУ┐ЏУАїтіат»єсђЂУДБт»є№╝їуД░СИ║тѕєу╗ёт»єуаЂсђѓ</p> <p><img src="http://dunwu.test.upcdn.net/cs/java/advanced/symmetric-encryption.png!zp" alt="img"></p> <p>тЂЄУ«Йућ▓С╣ЎТќ╣СйюСИ║жђџС┐АтЈїТќ╣сђѓтЂЄт«џућ▓С╣ЎтЈїТќ╣тюеТХѕТЂ»С╝ажђњтЅЇти▓тЋєт«џтіат»єу«ЌТ│Ћ№╝їТг▓т«їТѕљСИђТгАТХѕТЂ»С╝ажђњжюђУдЂу╗ЈУ┐ЄтдѓСИІТГЦжфцсђѓ</p> <p><img src="http://dunwu.test.upcdn.net/cs/java/advanced/symmetric-encryption-progress.png!zp" alt="img"></p> <h4 id="тиЦСйюТеАт╝Ј"><a href="#тиЦСйюТеАт╝Ј" class="header-anchor">#</a> тиЦСйюТеАт╝Ј</h4> <p>С╗Ц DES у«ЌТ│ЋуџётиЦСйюТеАт╝ЈСИ║СЙІ№╝їDES у«ЌТ│ЋТа╣ТЇ«тЁХтіат»єу«ЌТ│ЋТЅђт«џС╣ЅуџёТўјТќЄтѕєу╗ёуџётцДт░Ј№╝ѕ56 СйЇ№╝Ѕ№╝їт░єТЋ░ТЇ«тѕєтЅ▓ТѕљУІЦт╣▓ 56 СйЇуџётіат»єтї║тЮЌ№╝їтєЇС╗Цтіат»єтї║тЮЌСИ║тЇЋСйЇ№╝їтѕєтѕФУ┐ЏУАїтіат»єтцёуљєсђѓтдѓТъюТюђтљјтЅЕСИІСИЇУХ│СИђСИфтї║тЮЌуџётцДт░Ј№╝їуД░С╣ІСИ║<strong>уЪГтЮЌ</strong>сђѓуЪГтЮЌуџётцёуљєТќ╣Т│ЋТюЅтАФтЁЁТ│ЋсђЂТхЂт»єуаЂтіат»єТ│ЋсђЂт»єТќЄТїфућеТіђТю»сђѓ</p> <p>Та╣ТЇ«ТЋ░ТЇ«тіат»єТЌХТ»ЈСИфтіат»єтї║тЮЌУДЂтЙЌтЁ│УЂћТќ╣т╝ЈТЮЦтї║тѕє№╝їтЈ»С╗ЦтѕєСИ║С╗ЦСИІуДЇтиЦСйюТеАт╝Ј№╝џ</p> <p><strong>(1) ућхтГљт»єуаЂТюгТеАт╝Ј(Electronic Code Book, ECB)</strong></p> <p>ућежђћ№╝џжђѓтљѕтіат»єт»єжњЦ№╝їжџЈТю║ТЋ░уГЅуЪГТЋ░ТЇ«сђѓСЙІтдѓ№╝їт«ЅтЁетю░С╝ажђњ DES т»єжњЦ№╝їECB Тў»ТюђтљѕжђѓуџёТеАт╝Јсђѓ</p> <p><strong>(2) т»єТќЄжЊЙТјЦТеАт╝Ј(Cipher Booki Chaining, CBC)</strong></p> <p>ућежђћ№╝џтЈ»тіат»єС╗╗ТёЈжЋ┐т║дуџёТЋ░ТЇ«№╝їжђѓућеС║јУ«Ау«ЌС║ДућЪТБђТхІТЋ░ТЇ«т«їТЋ┤ТђДуџёТХѕТЂ»У«цУ»Ђ MACсђѓ</p> <p><strong>(3) т»єТќЄтЈЇждѕТеАт╝Ј(Cipher Feed Back, CFB)</strong></p> <p>ућежђћ№╝џтЏажћЎУ»»С╝аТњГТЌауЋї№╝їтЈ»С╗ЦућеС║јТБђТЪЦтЈЉуј░ТўјТќЄт»єТќЄуџёу»АТћ╣сђѓ</p> <p><strong>(4) УЙЊтЄ║тЈЇждѕТеАт╝Ј(Output Feed Back, OFB)</strong></p> <p>ућежђћ№╝џСй┐ућеС║јтіат»єтєЌСйЎТђДУЙЃтцДуџёТЋ░ТЇ«№╝їТ»ћтдѓУ»ГжЪ│тњїтЏЙтЃЈТЋ░ТЇ«сђѓ</p> <p>AES у«ЌТ│ЋжЎцС║єС╗ЦСИі 4 СИГТеАт╝Јтцќ№╝їУ┐ўТюЅСИђуДЇТќ░уџётиЦСйюТеАт╝Ј№╝џ</p> <p><strong>(5) У«АТЋ░тЎеТеАт╝Ј(Counter, CTR)</strong></p> <p>ућежђћ№╝џжђѓућеС║јтљёуДЇтіат»єт║ћућесђѓ</p> <p>ТюгТќЄт»╣С║јтљёуДЇтиЦСйюТеАт╝ЈуџётјЪуљєт▒Ћт╝ђТЈЈУ┐░сђѓСИфС║║У«цСИ║№╝їСйюСИ║тиЦуеІт║ћуће№╝їС║єУДБтЁХућежђћтЇ│тЈ»сђѓ</p> <h4 id="тАФтЁЁТќ╣Т│Ћ"><a href="#тАФтЁЁТќ╣Т│Ћ" class="header-anchor">#</a> тАФтЁЁТќ╣Т│Ћ</h4> <p>Java СИГт»╣уД░тіат»єт»╣С║јуЪГтЮЌуџётцёуљє№╝їСИђУѕгТў»жЄЄућетАФтЁЁТќ╣т╝Јсђѓ</p> <p>тИИжЄЄућеуџёТў»№╝џNoPadding№╝ѕСИЇтАФтЁЁ№╝ЅсђЂZeros тАФтЁЁ№╝ѕ0 тАФтЁЁ№╝ЅсђЂPKCS5Padding тАФтЁЁсђѓ</p> <p><strong>ZerosPadding</strong></p> <p>Тќ╣т╝Ј№╝џтЁежЃетАФтЁЁСИ║ 0 уџётГЌУіѓ</p> <p>у╗ЊТъютдѓСИІ№╝џ</p> <p>F1 F2 F3 F4 F5 F6 F7 F8 //уггСИђтЮЌ</p> <p>F9 00 00 00 00 00 00 00 //уггС║їтЮЌ</p> <p><strong>PKCS5Padding</strong></p> <p>Тќ╣т╝Ј№╝џТ»ЈСИфтАФтЁЁуџётГЌУіѓжЃйУ«░тйЋС║єтАФтЁЁуџёТђ╗тГЌУіѓТЋ░</p> <p>у╗ЊТъютдѓСИІ№╝џ</p> <p>F1 F2 F3 F4 F5 F6 F7 F8 //уггСИђтЮЌ</p> <p>F9 07 07 07 07 07 07 07 //уггС║їтЮЌ</p> <h4 id="тИИућеу«ЌТ│Ћ"><a href="#тИИућеу«ЌТ│Ћ" class="header-anchor">#</a> тИИућеу«ЌТ│Ћ</h4> <p>т»╣уД░тіат»єу«ЌТ│ЋСИ╗УдЂТюЅ DESсђЂ3DES№╝ѕTripleDES№╝ЅсђЂAESсђЂIDEAсђЂRC2сђЂRC4сђЂRC5 тњї Blowfish уГЅсђѓ</p> <h3 id="у«ЌТ│Ћт«ъуј░-2"><a href="#у«ЌТ│Ћт«ъуј░-2" class="header-anchor">#</a> у«ЌТ│Ћт«ъуј░</h3> <h4 id="тЪ║С║јт»єжњЦтіат»єуџёТхЂуеІ№╝ѕdesсђЂdesedeсђЂaes-тњї-idea№╝Ѕ"><a href="#тЪ║С║јт»єжњЦтіат»єуџёТхЂуеІ№╝ѕdesсђЂdesedeсђЂaes-тњї-idea№╝Ѕ" class="header-anchor">#</a> тЪ║С║јт»єжњЦтіат»єуџёТхЂуеІ№╝ѕDESсђЂDESedeсђЂAES тњї IDEA№╝Ѕ</h4> <p>DESсђЂDESedeсђЂAES тњї IDEA уГЅу«ЌТ│ЋжЃйТў»тЪ║С║јт»єжњЦтіат»єуџёт»╣уД░тіат»єу«ЌТ│Ћ№╝їт«ЃС╗гуџёт«ъуј░ТхЂуеІС╣ЪтЪ║ТюгСИђУЄ┤сђѓТГЦжфцтдѓСИІ№╝џ</p> <p>№╝ѕ1№╝ЅућЪТѕљт»єжњЦ</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">KeyGenerator</span> kg <span class="token operator">=</span> <span class="token class-name">KeyGenerator</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;DES&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">SecureRandom</span> random <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SecureRandom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
kg<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>random<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">SecretKey</span> secretKey <span class="token operator">=</span> kg<span class="token punctuation">.</span><span class="token function">generateKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>т╗║У««Сй┐ућежџЈТю║ТЋ░ТЮЦтѕЮтДІтїќт»єжњЦуџёућЪТѕљсђѓ</p> <p>№╝ѕ2№╝ЅтѕЮтДІтїќт»єуаЂт»╣У▒А</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Cipher</span> cipher <span class="token operator">=</span> <span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;DES/ECB/PKCS5Padding&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cipher<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">Cipher</span><span class="token punctuation">.</span>ENCRYPT_MODE<span class="token punctuation">,</span> secretKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>ENCRYPT_MODE</code>№╝џтіат»єТеАт╝Ј</p> <p><code>DECRYPT_MODE</code>№╝џУДБт»єТеАт╝Ј</p> <p>№╝ѕ3№╝ЅТЅДУАї</p> <div class="language- extra-class"><pre class="language-text"><code>String plaintext = &quot;Hello World&quot;;
byte[] ciphertext = cipher.doFinal(plaintext.getBytes());
</code></pre></div><h5 id="т«їТЋ┤т«ъСЙІ"><a href="#т«їТЋ┤т«ъСЙІ" class="header-anchor">#</a> т«їТЋ┤т«ъСЙІ</h5> <p>СИђСИфт«їТЋ┤уџё DES тіат»єУДБт»єУїЃСЙІ</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>bouncycastle<span class="token punctuation">.</span>util<span class="token punctuation">.</span>encoders</span><span class="token punctuation">.</span><span class="token class-name">Base64</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>zp<span class="token punctuation">.</span>javase<span class="token punctuation">.</span>security<span class="token punctuation">.</span>encode</span><span class="token punctuation">.</span><span class="token class-name">Encode</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>crypto</span><span class="token punctuation">.</span><span class="token class-name">BadPaddingException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>crypto</span><span class="token punctuation">.</span><span class="token class-name">Cipher</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>crypto</span><span class="token punctuation">.</span><span class="token class-name">IllegalBlockSizeException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>crypto</span><span class="token punctuation">.</span><span class="token class-name">KeyGenerator</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>crypto</span><span class="token punctuation">.</span><span class="token class-name">NoSuchPaddingException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span>spec</span><span class="token punctuation">.</span><span class="token class-name">IvParameterSpec</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>security</span><span class="token punctuation">.</span><span class="token class-name">InvalidAlgorithmParameterException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>security</span><span class="token punctuation">.</span><span class="token class-name">InvalidKeyException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>security</span><span class="token punctuation">.</span><span class="token class-name">Key</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>security</span><span class="token punctuation">.</span><span class="token class-name">NoSuchAlgorithmException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>security</span><span class="token punctuation">.</span><span class="token class-name">NoSuchProviderException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>security</span><span class="token punctuation">.</span><span class="token class-name">SecureRandom</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @Title DESCoder
 * @Description DESт«ЅтЁеу╝ќуаЂ№╝џТў»у╗ЈтЁИуџёт»╣уД░тіат»єу«ЌТ│Ћсђѓт»єжњЦС╗Ё56СйЇ№╝їСИћУ┐ГС╗БТгАТЋ░тЂЈт░Љсђѓти▓УбФУДєСИ║т╣ХСИЇт«ЅтЁеуџётіат»єу«ЌТ│Ћсђѓ
 * @Author Victor Zhang
 * @Date 2016т╣┤7Тюѕ14ТЌЦ
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DESCoder</span> <span class="token keyword">implements</span> <span class="token class-name">Encode</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> KEY_ALGORITHM_DES <span class="token operator">=</span> <span class="token string">&quot;DES&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> CIPHER_DES_DEFAULT <span class="token operator">=</span> <span class="token string">&quot;DES&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> CIPHER_DES_ECB_PKCS5PADDING <span class="token operator">=</span> <span class="token string">&quot;DES/ECB/PKCS5Padding&quot;</span><span class="token punctuation">;</span> <span class="token comment">// у«ЌТ│Ћ/ТеАт╝Ј/УАЦуаЂТќ╣т╝Ј</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> CIPHER_DES_CBC_PKCS5PADDING <span class="token operator">=</span> <span class="token string">&quot;DES/CBC/PKCS5Padding&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> CIPHER_DES_CBC_NOPADDING <span class="token operator">=</span> <span class="token string">&quot;DES/CBC/NoPadding&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> SEED <span class="token operator">=</span> <span class="token string">&quot;%%%today is nice***&quot;</span><span class="token punctuation">;</span> <span class="token comment">// ућеС║јућЪТѕљжџЈТю║ТЋ░уџёуДЇтГљ</span>

    <span class="token keyword">private</span> <span class="token class-name">Key</span> key<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Cipher</span> cipher<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> transformation<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">DESCoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">NoSuchAlgorithmException</span><span class="token punctuation">,</span> <span class="token class-name">NoSuchPaddingException</span><span class="token punctuation">,</span> <span class="token class-name">NoSuchProviderException</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>key <span class="token operator">=</span> <span class="token function">initKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>cipher <span class="token operator">=</span> <span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>CIPHER_DES_DEFAULT<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>transformation <span class="token operator">=</span> CIPHER_DES_DEFAULT<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">DESCoder</span><span class="token punctuation">(</span><span class="token class-name">String</span> transformation<span class="token punctuation">)</span>
            <span class="token keyword">throws</span> <span class="token class-name">NoSuchAlgorithmException</span><span class="token punctuation">,</span> <span class="token class-name">NoSuchPaddingException</span><span class="token punctuation">,</span> <span class="token class-name">NoSuchProviderException</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>key <span class="token operator">=</span> <span class="token function">initKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>cipher <span class="token operator">=</span> <span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>transformation<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>transformation <span class="token operator">=</span> transformation<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * @Title decrypt
     * @Description УДБт»є
     * @Author Victor Zhang
     * @Date 2016т╣┤7Тюѕ20ТЌЦ
     * @param input т»єТќЄ
     * @return byte[] ТўјТќЄ
     * @throws InvalidKeyException
     * @throws IllegalBlockSizeException
     * @throws BadPaddingException
     * @throws InvalidAlgorithmParameterException
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">decrypt</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> input<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InvalidKeyException</span><span class="token punctuation">,</span> <span class="token class-name">IllegalBlockSizeException</span><span class="token punctuation">,</span> <span class="token class-name">BadPaddingException</span><span class="token punctuation">,</span>
            <span class="token class-name">InvalidAlgorithmParameterException</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>transformation<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>CIPHER_DES_CBC_PKCS5PADDING<span class="token punctuation">)</span> <span class="token operator">||</span> transformation<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>CIPHER_DES_CBC_NOPADDING<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            cipher<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">Cipher</span><span class="token punctuation">.</span>DECRYPT_MODE<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">IvParameterSpec</span><span class="token punctuation">(</span><span class="token function">getIV</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            cipher<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">Cipher</span><span class="token punctuation">.</span>DECRYPT_MODE<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> cipher<span class="token punctuation">.</span><span class="token function">doFinal</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * @Title encrypt
     * @Description тіат»є
     * @Author Victor Zhang
     * @Date 2016т╣┤7Тюѕ20ТЌЦ
     * @param input ТўјТќЄ
     * @return byte[] т»єТќЄ
     * @throws InvalidKeyException
     * @throws IllegalBlockSizeException
     * @throws BadPaddingException
     * @throws InvalidAlgorithmParameterException
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">encrypt</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> input<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InvalidKeyException</span><span class="token punctuation">,</span> <span class="token class-name">IllegalBlockSizeException</span><span class="token punctuation">,</span> <span class="token class-name">BadPaddingException</span><span class="token punctuation">,</span>
            <span class="token class-name">InvalidAlgorithmParameterException</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>transformation<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>CIPHER_DES_CBC_PKCS5PADDING<span class="token punctuation">)</span> <span class="token operator">||</span> transformation<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>CIPHER_DES_CBC_NOPADDING<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            cipher<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">Cipher</span><span class="token punctuation">.</span>ENCRYPT_MODE<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">IvParameterSpec</span><span class="token punctuation">(</span><span class="token function">getIV</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            cipher<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">Cipher</span><span class="token punctuation">.</span>ENCRYPT_MODE<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> cipher<span class="token punctuation">.</span><span class="token function">doFinal</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * @Title initKey
     * @Description Та╣ТЇ«жџЈТю║ТЋ░уДЇтГљућЪТѕљСИђСИфт»єжњЦ
     * @Author Victor Zhang
     * @Date 2016т╣┤7Тюѕ14ТЌЦ
     * @Return Key
     * @throws NoSuchAlgorithmException
     * @throws NoSuchProviderException
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Key</span> <span class="token function">initKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">NoSuchAlgorithmException</span><span class="token punctuation">,</span> <span class="token class-name">NoSuchProviderException</span> <span class="token punctuation">{</span>
        <span class="token comment">// Та╣ТЇ«уДЇтГљућЪТѕљСИђСИфт«ЅтЁеуџёжџЈТю║ТЋ░</span>
        <span class="token class-name">SecureRandom</span> secureRandom <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        secureRandom <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SecureRandom</span><span class="token punctuation">(</span>SEED<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">KeyGenerator</span> keyGen <span class="token operator">=</span> <span class="token class-name">KeyGenerator</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>KEY_ALGORITHM_DES<span class="token punctuation">)</span><span class="token punctuation">;</span>
        keyGen<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>secureRandom<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> keyGen<span class="token punctuation">.</span><span class="token function">generateKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getIV</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> iv <span class="token operator">=</span> <span class="token string">&quot;01234567&quot;</span><span class="token punctuation">;</span> <span class="token comment">// IV length: must be 8 bytes long</span>
        <span class="token keyword">return</span> iv<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">DESCoder</span> aes <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DESCoder</span><span class="token punctuation">(</span>CIPHER_DES_CBC_PKCS5PADDING<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">String</span> msg <span class="token operator">=</span> <span class="token string">&quot;Hello World!&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;тјЪТќЄ: &quot;</span> <span class="token operator">+</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> encoded <span class="token operator">=</span> aes<span class="token punctuation">.</span><span class="token function">encrypt</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token string">&quot;UTF8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> encodedBase64 <span class="token operator">=</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">toBase64String</span><span class="token punctuation">(</span>encoded<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;т»єТќЄ: &quot;</span> <span class="token operator">+</span> encodedBase64<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> decodedBase64 <span class="token operator">=</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>encodedBase64<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> decoded <span class="token operator">=</span> aes<span class="token punctuation">.</span><span class="token function">decrypt</span><span class="token punctuation">(</span>decodedBase64<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ТўјТќЄ: &quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>decoded<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>УЙЊтЄ║</strong></p> <div class="language- extra-class"><pre class="language-text"><code>тјЪТќЄ: Hello World!
т»єТќЄ: TtnEu9ezNQtxFKpmq/37Qw==
ТўјТќЄ: Hello World!
</code></pre></div><h4 id="тЪ║С║јтЈБС╗цтіат»єуџёТхЂуеІ№╝ѕpbe№╝Ѕ"><a href="#тЪ║С║јтЈБС╗цтіат»єуџёТхЂуеІ№╝ѕpbe№╝Ѕ" class="header-anchor">#</a> тЪ║С║јтЈБС╗цтіат»єуџёТхЂуеІ№╝ѕPBE№╝Ѕ</h4> <p>DESсђЂDESedeсђЂAESсђЂIDEA У┐ЎтЄауДЇу«ЌТ│Ћуџёт║ћућеТеАтъІтЄаС╣јтдѓтЄ║СИђУЙЎсђѓ</p> <p>СйєТў»№╝їт╣ХжЮъТЅђТюЅт»╣уД░тіат»єу«ЌТ│ЋжЃйТў»тдѓТГцсђѓ</p> <p>тЪ║С║јтЈБС╗цтіат»є(Password Based Encryption, PBE)Тў»СИђуДЇтЪ║С║јтЈБС╗цтіат»єуџёу«ЌТ│ЋсђѓтЁХуЅ╣уѓ╣Тў»№╝џтЈБС╗цућ▒ућеТѕиУЄфти▒Тјїу«А№╝їжЄЄућежџЈТю║ТЋ░№╝ѕУ┐ЎжЄїтЈФтЂџуЏљ№╝ЅТЮѓтЄЉтцџжЄЇтіат»єуГЅТќ╣Т│ЋС┐ЮУ»ЂТЋ░ТЇ«уџёт«ЅтЁеТђДсђѓ</p> <p>PBE Т▓АТюЅт»єжњЦТдѓт┐х№╝їт»єжњЦтюетЁХС╗ќт»╣уД░тіат»єу«ЌТ│ЋСИГТў»у╗ЈУ┐ЄУ«Ау«ЌтЙЌтЄ║уџё№╝їPBE тѕЎСй┐ућетЈБС╗цТЏ┐С╗БС║єт»єжњЦсђѓ</p> <p>ТхЂуеІ№╝џ</p> <p><img src="http://dunwu.test.upcdn.net/cs/java/advanced/password-based-encryption-progress.png!zp" alt="img"></p> <p>ТГЦжфцтдѓСИІ№╝џ</p> <p><strong>№╝ѕ1№╝ЅС║ДућЪуЏљ</strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">SecureRandom</span> secureRandom <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SecureRandom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> salt <span class="token operator">=</span> secureRandom<span class="token punctuation">.</span><span class="token function">generateSeed</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// уЏљжЋ┐т║дт┐ЁжА╗СИ║8тГЌУіѓ</span>
</code></pre></div><p><strong>№╝ѕ2№╝ЅТа╣ТЇ«т»єуаЂС║ДућЪ Key</strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">String</span> password <span class="token operator">=</span> <span class="token string">&quot;123456&quot;</span><span class="token punctuation">;</span>
<span class="token class-name">PBEKeySpec</span> keySpec <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PBEKeySpec</span><span class="token punctuation">(</span>password<span class="token punctuation">.</span><span class="token function">toCharArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">SecretKeyFactory</span> keyFactory <span class="token operator">=</span> <span class="token class-name">SecretKeyFactory</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>KEY_ALGORITHM<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">SecretKey</span> secretKey <span class="token operator">=</span> keyFactory<span class="token punctuation">.</span><span class="token function">generateSecret</span><span class="token punctuation">(</span>keySpec<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>№╝ѕ3№╝ЅтѕЮтДІтїќтіат»єТѕќУДБт»єт»╣У▒А</strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">PBEParameterSpec</span> paramSpec <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PBEParameterSpec</span><span class="token punctuation">(</span>salt<span class="token punctuation">,</span> ITERATION_COUNT<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Cipher</span> cipher <span class="token operator">=</span> <span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>KEY_ALGORITHM<span class="token punctuation">)</span><span class="token punctuation">;</span>
cipher<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">Cipher</span><span class="token punctuation">.</span>ENCRYPT_MODE<span class="token punctuation">,</span> secretKey<span class="token punctuation">,</span> paramSpec<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>№╝ѕ4№╝ЅТЅДУАї</strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> plaintext <span class="token operator">=</span> <span class="token string">&quot;Hello World&quot;</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ciphertext <span class="token operator">=</span> cipher<span class="token punctuation">.</span><span class="token function">doFinal</span><span class="token punctuation">(</span>plaintext<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="жЮът»╣уД░тіат»є"><a href="#жЮът»╣уД░тіат»є" class="header-anchor">#</a> жЮът»╣уД░тіат»є</h2> <h3 id="у«ЌТ│Ћу«ђУ┐░-3"><a href="#у«ЌТ│Ћу«ђУ┐░-3" class="header-anchor">#</a> у«ЌТ│Ћу«ђУ┐░</h3> <p>жЮът»╣уД░тіат»єу«ЌТ│Ћтњїт»╣уД░тіат»єу«ЌТ│ЋуџёСИ╗УдЂти«тѕФтюеС║јжЮът»╣уД░тіат»єу«ЌТ│ЋућеС║јтіат»єтњїУДБт»єуџёт»єжњЦТў»СИЇтљїуџёсђѓСИђСИфтЁгт╝ђ№╝їуД░СИ║тЁгжњЦ№╝ѕpublic key№╝Ѕ№╝ЏСИђСИфС┐Ют»є№╝їуД░СИ║уДЂжњЦ№╝ѕprivate key№╝ЅсђѓтЏаТГц№╝їжЮът»╣уД░тіат»єу«ЌТ│ЋС╣ЪуД░СИ║тЈїжњЦтіат»єу«ЌТ│ЋТѕќтЁгжњЦтіат»єу«ЌТ│Ћсђѓ</p> <h4 id="уЅ╣уѓ╣-2"><a href="#уЅ╣уѓ╣-2" class="header-anchor">#</a> уЅ╣уѓ╣</h4> <h5 id="С╝ўуѓ╣"><a href="#С╝ўуѓ╣" class="header-anchor">#</a> С╝ўуѓ╣</h5> <p>жЮът»╣уД░тіат»єу«ЌТ│ЋУДБтє│С║єт»╣уД░тіат»єу«ЌТ│Ћуџёт»єжњЦтѕєжЁЇжЌ«жбў№╝їт╣ХТъЂтцДтю░ТЈљжФўС║єу«ЌТ│Ћт«ЅтЁеТђДсђѓ</p> <h5 id="у╝║уѓ╣"><a href="#у╝║уѓ╣" class="header-anchor">#</a> у╝║уѓ╣</h5> <p>у«ЌТ│ЋТ»ћт»╣уД░у«ЌТ│ЋТЏ┤тцЇТЮѓ№╝їтЏаТГцтіат»єсђЂУДБт»єжђЪт║джЃйТ»ћт»╣уД░у«ЌТ│ЋТЁбтЙѕтцџсђѓ</p> <h4 id="тјЪуљє-3"><a href="#тјЪуљє-3" class="header-anchor">#</a> тјЪуљє</h4> <p><img src="http://dunwu.test.upcdn.net/cs/java/advanced/asymmetric-encryption.png!zp" alt="img"></p> <p>жЮът»╣уД░тіат»єу«ЌТ│Ћт«ъуј░Тю║т»єС┐АТЂ»С║цТЇбуџётЪ║ТюгУ┐ЄуеІТў»№╝џућ▓Тќ╣ућЪТѕљСИђт»╣т»єжњЦт╣Хт░єтЁХСИГуџёСИђТііСйюСИ║тЁгућет»єжњЦтљЉтЁХт«ЃТќ╣тЁгт╝ђ№╝ЏтЙЌтѕ░У»ЦтЁгућет»єжњЦуџёС╣ЎТќ╣Сй┐ућеУ»Цт»єжњЦт»╣Тю║т»єС┐АТЂ»У┐ЏУАїтіат»єтљјтєЇтЈЉжђЂу╗Ўућ▓Тќ╣№╝Џућ▓Тќ╣тєЇућеУЄфти▒С┐ЮтГўуџётЈдСИђТііСИЊућет»єжњЦт»╣тіат»єтљјуџёС┐АТЂ»У┐ЏУАїУДБт»єсђѓ</p> <p>тЈдСИђТќ╣жЮб№╝їућ▓Тќ╣тЈ»С╗ЦСй┐ућеС╣ЎТќ╣уџётЁгжњЦт»╣Тю║т»єС┐АТЂ»У┐ЏУАїуГЙтљЇтљјтєЇтЈЉжђЂу╗ЎС╣ЎТќ╣№╝ЏС╣ЎТќ╣тєЇућеУЄфти▒уџёуДЂтїЎт»╣ТЋ░ТЇ«У┐ЏУАїжфїУ»Ђсђѓ</p> <p>ућ▓Тќ╣тЈфУЃйућетЁХуДЂжњЦУДБт»є№╝їућ▒тЁХтЁгжњЦтіат»єтљјуџёС╗╗СйЋС┐АТЂ»сђѓ жЮът»╣уД░тіат»єу«ЌТ│ЋуџёС┐Ют»єТђДТ»ћУЙЃтЦй№╝їт«ЃТХѕжЎцС║єТюђу╗ѕућеТѕиС║цТЇбт»єжњЦуџёжюђУдЂсђѓ</p> <h4 id="тИИућеу«ЌТ│Ћ-2"><a href="#тИИућеу«ЌТ│Ћ-2" class="header-anchor">#</a> тИИућеу«ЌТ│Ћ</h4> <p>DH(Diffie-Hellman№╝їт»єжњЦС║цТЇбу«ЌТ│Ћ)сђЂRSA</p> <h3 id="у«ЌТ│Ћт«ъуј░-3"><a href="#у«ЌТ│Ћт«ъуј░-3" class="header-anchor">#</a> у«ЌТ│Ћт«ъуј░</h3> <h4 id="т«їТЋ┤УїЃСЙІ"><a href="#т«їТЋ┤УїЃСЙІ" class="header-anchor">#</a> т«їТЋ┤УїЃСЙІ</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>codec<span class="token punctuation">.</span>binary</span><span class="token punctuation">.</span><span class="token class-name">Base64</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>crypto</span><span class="token punctuation">.</span><span class="token class-name">Cipher</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>security</span><span class="token punctuation">.</span><span class="token class-name">KeyFactory</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>security</span><span class="token punctuation">.</span><span class="token class-name">KeyPair</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>security</span><span class="token punctuation">.</span><span class="token class-name">KeyPairGenerator</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>security</span><span class="token punctuation">.</span><span class="token class-name">PrivateKey</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>security</span><span class="token punctuation">.</span><span class="token class-name">PublicKey</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>security<span class="token punctuation">.</span>spec</span><span class="token punctuation">.</span><span class="token class-name">PKCS8EncodedKeySpec</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>security<span class="token punctuation">.</span>spec</span><span class="token punctuation">.</span><span class="token class-name">X509EncodedKeySpec</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RSACoder</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token class-name">String</span> KEY_ALGORITHM <span class="token operator">=</span> <span class="token string">&quot;RSA&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">KeyPair</span> keyPair<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">RSACoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>keyPair <span class="token operator">=</span> <span class="token function">initKeyPair</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">encryptByPublicKey</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> plaintext<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> key<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">X509EncodedKeySpec</span> keySpec <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">X509EncodedKeySpec</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">KeyFactory</span> keyFactory <span class="token operator">=</span> <span class="token class-name">KeyFactory</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>KEY_ALGORITHM<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PublicKey</span> publicKey <span class="token operator">=</span> keyFactory<span class="token punctuation">.</span><span class="token function">generatePublic</span><span class="token punctuation">(</span>keySpec<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Cipher</span> cipher <span class="token operator">=</span> <span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>keyFactory<span class="token punctuation">.</span><span class="token function">getAlgorithm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        cipher<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">Cipher</span><span class="token punctuation">.</span>ENCRYPT_MODE<span class="token punctuation">,</span> publicKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> cipher<span class="token punctuation">.</span><span class="token function">doFinal</span><span class="token punctuation">(</span>plaintext<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">encryptByPrivateKey</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> plaintext<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> key<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">PKCS8EncodedKeySpec</span> keySpec <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PKCS8EncodedKeySpec</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">KeyFactory</span> keyFactory <span class="token operator">=</span> <span class="token class-name">KeyFactory</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>KEY_ALGORITHM<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PrivateKey</span> privateKey <span class="token operator">=</span> keyFactory<span class="token punctuation">.</span><span class="token function">generatePrivate</span><span class="token punctuation">(</span>keySpec<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Cipher</span> cipher <span class="token operator">=</span> <span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>keyFactory<span class="token punctuation">.</span><span class="token function">getAlgorithm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        cipher<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">Cipher</span><span class="token punctuation">.</span>ENCRYPT_MODE<span class="token punctuation">,</span> privateKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> cipher<span class="token punctuation">.</span><span class="token function">doFinal</span><span class="token punctuation">(</span>plaintext<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">decryptByPublicKey</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ciphertext<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> key<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">X509EncodedKeySpec</span> keySpec <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">X509EncodedKeySpec</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">KeyFactory</span> keyFactory <span class="token operator">=</span> <span class="token class-name">KeyFactory</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>KEY_ALGORITHM<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PublicKey</span> publicKey <span class="token operator">=</span> keyFactory<span class="token punctuation">.</span><span class="token function">generatePublic</span><span class="token punctuation">(</span>keySpec<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Cipher</span> cipher <span class="token operator">=</span> <span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>keyFactory<span class="token punctuation">.</span><span class="token function">getAlgorithm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        cipher<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">Cipher</span><span class="token punctuation">.</span>DECRYPT_MODE<span class="token punctuation">,</span> publicKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> cipher<span class="token punctuation">.</span><span class="token function">doFinal</span><span class="token punctuation">(</span>ciphertext<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">decryptByPrivateKey</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ciphertext<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> key<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">PKCS8EncodedKeySpec</span> keySpec <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PKCS8EncodedKeySpec</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">KeyFactory</span> keyFactory <span class="token operator">=</span> <span class="token class-name">KeyFactory</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>KEY_ALGORITHM<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PrivateKey</span> privateKey <span class="token operator">=</span> keyFactory<span class="token punctuation">.</span><span class="token function">generatePrivate</span><span class="token punctuation">(</span>keySpec<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Cipher</span> cipher <span class="token operator">=</span> <span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>keyFactory<span class="token punctuation">.</span><span class="token function">getAlgorithm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        cipher<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">Cipher</span><span class="token punctuation">.</span>DECRYPT_MODE<span class="token punctuation">,</span> privateKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> cipher<span class="token punctuation">.</span><span class="token function">doFinal</span><span class="token punctuation">(</span>ciphertext<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token class-name">KeyPair</span> <span class="token function">initKeyPair</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">// KeyPairGeneratorу▒╗ућеС║јућЪТѕљтЁгжњЦтњїуДЂжњЦт»╣№╝їтЪ║С║јRSAу«ЌТ│ЋућЪТѕљт»╣У▒А</span>
        <span class="token class-name">KeyPairGenerator</span> keyPairGen <span class="token operator">=</span> <span class="token class-name">KeyPairGenerator</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>KEY_ALGORITHM<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// тѕЮтДІтїќт»єжњЦт»╣ућЪТѕљтЎе№╝їт»єжњЦтцДт░ЈСИ║1024СйЇ</span>
        keyPairGen<span class="token punctuation">.</span><span class="token function">initialize</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ућЪТѕљСИђСИфт»єжњЦт»╣</span>
        <span class="token keyword">return</span> keyPairGen<span class="token punctuation">.</span><span class="token function">genKeyPair</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> msg <span class="token operator">=</span> <span class="token string">&quot;Hello World!&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">RSACoder</span> coder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RSACoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// уДЂжњЦтіат»є№╝їтЁгжњЦУДБт»є</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ciphertext <span class="token operator">=</span> coder<span class="token punctuation">.</span><span class="token function">encryptByPrivateKey</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token string">&quot;UTF8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> coder<span class="token punctuation">.</span>keyPair<span class="token punctuation">.</span><span class="token function">getPrivate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getEncoded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> plaintext <span class="token operator">=</span> coder<span class="token punctuation">.</span><span class="token function">decryptByPublicKey</span><span class="token punctuation">(</span>ciphertext<span class="token punctuation">,</span> coder<span class="token punctuation">.</span>keyPair<span class="token punctuation">.</span><span class="token function">getPublic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getEncoded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// тЁгжњЦтіат»є№╝їуДЂжњЦУДБт»є</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ciphertext2 <span class="token operator">=</span> coder<span class="token punctuation">.</span><span class="token function">encryptByPublicKey</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> coder<span class="token punctuation">.</span>keyPair<span class="token punctuation">.</span><span class="token function">getPublic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getEncoded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> plaintext2 <span class="token operator">=</span> coder<span class="token punctuation">.</span><span class="token function">decryptByPrivateKey</span><span class="token punctuation">(</span>ciphertext2<span class="token punctuation">,</span> coder<span class="token punctuation">.</span>keyPair<span class="token punctuation">.</span><span class="token function">getPrivate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getEncoded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;тјЪТќЄ№╝џ&quot;</span> <span class="token operator">+</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;тЁгжњЦ№╝џ&quot;</span> <span class="token operator">+</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">encodeBase64URLSafeString</span><span class="token punctuation">(</span>coder<span class="token punctuation">.</span>keyPair<span class="token punctuation">.</span><span class="token function">getPublic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getEncoded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;уДЂжњЦ№╝џ&quot;</span> <span class="token operator">+</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">encodeBase64URLSafeString</span><span class="token punctuation">(</span>coder<span class="token punctuation">.</span>keyPair<span class="token punctuation">.</span><span class="token function">getPrivate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getEncoded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;============== уДЂжњЦтіат»є№╝їтЁгжњЦУДБт»є ==============&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;т»єТќЄ№╝џ&quot;</span> <span class="token operator">+</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">encodeBase64URLSafeString</span><span class="token punctuation">(</span>ciphertext<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ТўјТќЄ№╝џ&quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>plaintext<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;============== тЁгжњЦтіат»є№╝їуДЂжњЦУДБт»є ==============&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;т»єТќЄ№╝џ&quot;</span> <span class="token operator">+</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">encodeBase64URLSafeString</span><span class="token punctuation">(</span>ciphertext2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ТўјТќЄ№╝џ&quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>plaintext2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>УЙЊтЄ║</strong></p> <div class="language- extra-class"><pre class="language-text"><code>тјЪТќЄ№╝џHello World!
тЁгжњЦ№╝џMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCVN2mWAMdatpo2l8dwavaX2VC8mRleVTdjwjyahsyCE6UxkdqHsKD6Ecq3OBbuJhEfHxnr7MAD_zoE6zalFs7_si09XTgpVFsFCztPXJpPw-rpQdvaaxYEXJHkY07M_DBrxh1URg2gQl9dEDaruIFrZ12ugTwwEkLA1K_LN7yZrwIDAQAB
уДЂжњЦ№╝џMIICdQIBADANBgkqhkiG9w0BAQEFAASCAl8wggJbAgEAAoGBAJU3aZYAx1q2mjaXx3Bq9pfZULyZGV5VN2PCPJqGzIITpTGR2oewoPoRyrc4Fu4mER8fGevswAP_OgTrNqUWzv-yLT1dOClUWwULO09cmk_D6ulB29prFgRckeRjTsz8MGvGHVRGDaBCX10QNqu4gWtnXa6BPDASQsDUr8s3vJmvAgMBAAECgYBvU1M8LcKOJFQzzNNoRPVLX0AEJXkuzwcvL1hFtbJYjc2eiQHwYFAJokKKpZc-ADqf7HVLdmvfz4h66P3w925hYHjSF3cs6jiibI7fc9lrdrJLMpv44phPlRCiIanD-U6pyN3bZxRl4Giuz5uGL0SVU6Dxh2Sw7mtnvUBbHCyyaQJBAOixpR-t81Qnpdy4jlbZL8ufTTF1TzlSh0NEDB4tlpHlVolVmZB2M-rdJ3nP8fJXazdsGZMP0q38vgiN2HHMtxsCQQCkKWAaA6KxKNbj0mJDSP1p4qUJ4EAcgXBz4B_PKMZa3ZU2CdmFlhlLRRTOIjZX2VC6IjHKWssa-3V2EqBzCSz9AkBsiK9kH1anofaTBOIfUB4i86KltvnE2uGMVmjwioL4eefrFqoR35BHs-99uag4SN4Rc7JaDb9Ot9xLUR3rtniRAkB8dFXEQx9Teie4HmaapjpgzQ_b9eQE-GjdoHvdHQeMGdMmXb9IVGwmsV-9ixhx73IROx1OURkMArmhYyu7KqitAkBkeQ-7AYOIROJnTUSQTMUELUmZFF1Io_SJGXyRYLgDqz7JCmmhfH7sNm8Gcn6f2VWg-U2D9-G5IHO-vHfz2DS6
============== уДЂжњЦтіат»є№╝їтЁгжњЦУДБт»є ==============
т»єТќЄ№╝џU2otXypy1Fg4wcXK187xAuOxWM88oORVDJfaNxvG74Q_rqZ-sT4fEZYLZO80KmsWiufkJbD9Gskgkg7dRPRCwG90pRaU3PD9_sTmksN0v8MUwCX2p80zUeG3gWU6BJwMMUZrltJaHFbKn-BhzoNrn3Q-4BJA8lt6-cKtH0TPeN4
ТўјТќЄ№╝џHello World!
============== тЁгжњЦтіат»є№╝їуДЂжњЦУДБт»є ==============
т»єТќЄ№╝џO_rknvo12qaFfWieyTI_Ay8_ph49y3V4jJVs1BykpI81GM3ozCPSnOjHbtdWdjPtgJHFfCjbspAnIT2eM4PtJldIJg6k_2HZCmCCaheUj2pxcvkrhb6GdhSlH-K2FhFGAnlxUAp-3tZpYpxzAteEw1-suldelHdikrCV_uXxAEM
ТўјТќЄ№╝џHello World!
</code></pre></div><h2 id="ТХѕТЂ»ТЉўУдЂ"><a href="#ТХѕТЂ»ТЉўУдЂ" class="header-anchor">#</a> ТХѕТЂ»ТЉўУдЂ</h2> <h3 id="у«ЌТ│Ћу«ђУ┐░-4"><a href="#у«ЌТ│Ћу«ђУ┐░-4" class="header-anchor">#</a> у«ЌТ│Ћу«ђУ┐░</h3> <h4 id="т«џС╣Ѕ-2"><a href="#т«џС╣Ѕ-2" class="header-anchor">#</a> т«џС╣Ѕ</h4> <p>т«ЃТў»СИђСИфтћ»СИђт»╣т║ћСИђСИфТХѕТЂ»ТѕќТќЄТюгуџётЏ║т«џжЋ┐т║дуџётђ╝№╝їт«Ѓућ▒СИђСИфтЇЋтљЉ Hash тіат»єтЄйТЋ░т»╣ТХѕТЂ»У┐ЏУАїСйюућеУђїС║ДућЪсђѓтдѓТъюТХѕТЂ»тюежђћСИГТћ╣тЈўС║є№╝їтѕЎТјЦТћХУђЁжђџУ┐Єт»╣ТћХтѕ░ТХѕТЂ»уџёТќ░С║ДућЪуџёТЉўУдЂСИјтјЪТЉўУдЂТ»ћУЙЃ№╝їт░▒тЈ»уЪЦжЂЊТХѕТЂ»Тў»тљдУбФТћ╣тЈўС║єсђѓтЏаТГцТХѕТЂ»ТЉўУдЂС┐ЮУ»ЂС║єТХѕТЂ»уџёт«їТЋ┤ТђДсђѓТХѕТЂ»ТЉўУдЂжЄЄућетЇЋтљЉ Hash тЄйТЋ░т░єжюђтіат»єуџёТўјТќЄ&quot;ТЉўУдЂ&quot;ТѕљСИђСИ▓т»єТќЄ№╝їУ┐ЎСИђСИ▓т»єТќЄС║дуД░СИ║ТЋ░тГЌТїЄу║╣(Finger Print)сђѓт«ЃТюЅтЏ║т«џуџёжЋ┐т║д№╝їСИћСИЇтљїуџёТўјТќЄТЉўУдЂТѕљт»єТќЄ№╝їтЁХу╗ЊТъюТђ╗Тў»СИЇтљїуџё№╝їУђїтљїТаиуџёТўјТќЄтЁХТЉўУдЂт┐Ёт«џСИђУЄ┤сђѓУ┐ЎТаиУ┐ЎСИ▓ТЉўУдЂСЙ┐тЈ»ТѕљСИ║жфїУ»ЂТўјТќЄТў»тљдТў»&quot;уюЪУ║Ф&quot;уџё&quot;ТїЄу║╣&quot;С║єсђѓ</p> <h4 id="уЅ╣уѓ╣-3"><a href="#уЅ╣уѓ╣-3" class="header-anchor">#</a> уЅ╣уѓ╣</h4> <p>ТХѕТЂ»ТЉўУдЂтЁиТюЅС╗ЦСИІуЅ╣уѓ╣№╝џ</p> <ul><li>тћ»СИђТђД№╝џТЋ░ТЇ«тЈфУдЂТюЅСИђуѓ╣Тћ╣тЈў№╝їжѓБС╣ѕтєЇжђџУ┐ЄТХѕТЂ»ТЉўУдЂу«ЌТ│ЋтЙЌтѕ░уџёТЉўУдЂС╣ЪС╝џтЈЉућЪтЈўтїќсђѓУЎйуёХуљєУ«║СИіТюЅтЈ»УЃйС╝џтЈЉућЪуб░Тњъ№╝їСйєТў»ТдѓујЄТъЂтЁХСйјсђѓ</li> <li>СИЇтЈ»жђє№╝џТХѕТЂ»ТЉўУдЂу«ЌТ│Ћуџёт»єТќЄТЌаТ│ЋУбФУДБт»єсђѓ</li> <li>СИЇжюђУдЂт»єжњЦ№╝їтЈ»Сй┐ућеС║јтѕєтИЃт╝ЈуйЉу╗юсђѓ</li> <li>ТЌаУ«║УЙЊтЁЦуџёТўјТќЄТюЅтцџжЋ┐№╝їУ«Ау«ЌтЄ║ТЮЦуџёТХѕТЂ»ТЉўУдЂуџёжЋ┐т║дТђ╗Тў»тЏ║т«џуџёсђѓ</li></ul> <h4 id="тјЪуљє-4"><a href="#тјЪуљє-4" class="header-anchor">#</a> тјЪуљє</h4> <p>ТХѕТЂ»ТЉўУдЂ№╝їтЁХт«ът░▒Тў»т░єжюђУдЂТЉўУдЂуџёТЋ░ТЇ«СйюСИ║тЈѓТЋ░№╝їу╗ЈУ┐ЄтЊѕтИїтЄйТЋ░(Hash)уџёУ«Ау«Ќ№╝їтЙЌтѕ░уџёТЋБтѕЌтђ╝сђѓ</p> <h4 id="тИИућеу«ЌТ│Ћ-3"><a href="#тИИућеу«ЌТ│Ћ-3" class="header-anchor">#</a> тИИућеу«ЌТ│Ћ</h4> <p>ТХѕТЂ»ТЉўУдЂу«ЌТ│ЋтїЁТІг<strong>MD(Message Digest№╝їТХѕТЂ»ТЉўУдЂу«ЌТ│Ћ)</strong>сђЂ<strong>SHA(Secure Hash Algorithm№╝їт«ЅтЁеТЋБтѕЌу«ЌТ│Ћ)</strong>сђЂ**MAC(Message AuthenticationCode№╝їТХѕТЂ»У«цУ»ЂуаЂу«ЌТ│Ћ)**тЁ▒ 3 тцДу│╗тѕЌ№╝їтИИућеС║јжфїУ»ЂТЋ░ТЇ«уџёт«їТЋ┤ТђД№╝їТў»ТЋ░тГЌуГЙтљЇу«ЌТ│ЋуџёТаИт┐Ѓу«ЌТ│Ћсђѓ</p> <p><strong>MD5</strong>тњї<strong>SHA1</strong>тѕєтѕФТў»<strong>MD</strong>сђЂ<strong>SHA</strong>у«ЌТ│Ћу│╗тѕЌСИГТюђТюЅС╗БУАеТђДуџёу«ЌТ│Ћсђѓ</p> <p>тдѓС╗і№╝їMD5 ти▓УбФтЈЉуј░ТюЅУ«ИтцџТ╝ЈТ┤ъ№╝їС╗јУђїСИЇтєЇт«ЅтЁесђѓSHA у«ЌТ│ЋТ»ћ MD у«ЌТ│ЋуџёТЉўУдЂжЋ┐т║дТЏ┤жЋ┐№╝їС╣ЪТЏ┤тіат«ЅтЁесђѓ</p> <h3 id="у«ЌТ│Ћт«ъуј░-4"><a href="#у«ЌТ│Ћт«ъуј░-4" class="header-anchor">#</a> у«ЌТ│Ћт«ъуј░</h3> <h4 id="md5сђЂsha-уџёУїЃСЙІ"><a href="#md5сђЂsha-уџёУїЃСЙІ" class="header-anchor">#</a> MD5сђЂSHA уџёУїЃСЙІ</h4> <p>JDK СИГСй┐уће MD5 тњї SHA У┐ЎСИцуДЇТХѕТЂ»ТЉўУдЂуџёТќ╣т╝ЈтЪ║ТюгСИђУЄ┤№╝їТГЦжфцтдѓСИІ№╝џ</p> <ol><li>тѕЮтДІтїќ MessageDigest т»╣У▒А</li> <li>ТЏ┤Тќ░УдЂУ«Ау«ЌуџётєЁт«╣</li> <li>ућЪТѕљТЉўУдЂ</li></ol> <p><strong>УїЃСЙІ</strong></p> <div class="language-java extra-class"><pre class="language-java"><code>importjava<span class="token punctuation">.</span>io<span class="token punctuation">.</span><span class="token class-name">UnsupportedEncodingException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>security</span><span class="token punctuation">.</span><span class="token class-name">MessageDigest</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>security</span><span class="token punctuation">.</span><span class="token class-name">NoSuchAlgorithmException</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>codec<span class="token punctuation">.</span>binary</span><span class="token punctuation">.</span><span class="token class-name">Base64</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MsgDigestDemo</span><span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span> args<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">NoSuchAlgorithmException</span><span class="token punctuation">,</span> <span class="token class-name">UnsupportedEncodingException</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> msg <span class="token operator">=</span> <span class="token string">&quot;Hello World!&quot;</span><span class="token punctuation">;</span>

        <span class="token class-name">MessageDigest</span> md5Digest <span class="token operator">=</span> <span class="token class-name">MessageDigest</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;MD5&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ТЏ┤Тќ░УдЂУ«Ау«ЌуџётєЁт«╣</span>
        md5Digest<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// т«їТѕљтЊѕтИїУ«Ау«Ќ№╝їтЙЌтѕ░ТЉўУдЂ</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> md5Encoded <span class="token operator">=</span> md5Digest<span class="token punctuation">.</span><span class="token function">digest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">MessageDigest</span> shaDigest <span class="token operator">=</span> <span class="token class-name">MessageDigest</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">&quot;SHA&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ТЏ┤Тќ░УдЂУ«Ау«ЌуџётєЁт«╣</span>
        shaDigest<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// т«їТѕљтЊѕтИїУ«Ау«Ќ№╝їтЙЌтѕ░ТЉўУдЂ</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> shaEncoded <span class="token operator">=</span> shaDigest<span class="token punctuation">.</span><span class="token function">digest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;тјЪТќЄ: &quot;</span> <span class="token operator">+</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;MD5ТЉўУдЂ: &quot;</span> <span class="token operator">+</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">encodeBase64URLSafeString</span><span class="token punctuation">(</span>md5Encoded<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;SHAТЉўУдЂ: &quot;</span> <span class="token operator">+</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">encodeBase64URLSafeString</span><span class="token punctuation">(</span>shaEncoded<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>УЙЊтЄ║</strong></p> <div class="language- extra-class"><pre class="language-text"><code>тјЪТќЄ:Hello World!
MD5ТЉўУдЂ: 7Qdih1MuhjZehB6Sv8UNjA
SHAТЉўУдЂ:Lve95gjOVATpfV8EL5X4nxwjKHE
</code></pre></div><h4 id="hmac-уџёУїЃСЙІ"><a href="#hmac-уџёУїЃСЙІ" class="header-anchor">#</a> HMAC уџёУїЃСЙІ</h4> <div class="language-java extra-class"><pre class="language-java"><code>importjavax<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span><span class="token class-name">Mac</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span>spec</span><span class="token punctuation">.</span><span class="token class-name">SecretKeySpec</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>codec<span class="token punctuation">.</span>binary</span><span class="token punctuation">.</span><span class="token class-name">Base64</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HmacCoder</span><span class="token punctuation">{</span>
    <span class="token comment">/**
     * JDKТћ»ТїЂHmacMD5, HmacSHA1,HmacSHA256, HmacSHA384, HmacSHA512
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">HmacTypeEn</span> <span class="token punctuation">{</span>
        <span class="token class-name">HmacMD5</span><span class="token punctuation">,</span> <span class="token class-name">HmacSHA1</span><span class="token punctuation">,</span> <span class="token class-name">HmacSHA256</span><span class="token punctuation">,</span> <span class="token class-name">HmacSHA384</span><span class="token punctuation">,</span> <span class="token class-name">HmacSHA512</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">encode</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> plaintext<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> secretKey<span class="token punctuation">,</span> <span class="token class-name">HmacTypeEn</span> type<span class="token punctuation">)</span> throwsException <span class="token punctuation">{</span>
        <span class="token class-name">SecretKeySpec</span> keySpec <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SecretKeySpec</span><span class="token punctuation">(</span>secretKey<span class="token punctuation">,</span> type<span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Mac</span> mac <span class="token operator">=</span> <span class="token class-name">Mac</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>keySpec<span class="token punctuation">.</span><span class="token function">getAlgorithm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mac<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>keySpec<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> mac<span class="token punctuation">.</span><span class="token function">doFinal</span><span class="token punctuation">(</span>plaintext<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> msg <span class="token operator">=</span> <span class="token string">&quot;Hello World!&quot;</span><span class="token punctuation">;</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> secretKey <span class="token operator">=</span> <span class="token string">&quot;Secret_Key&quot;</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token string">&quot;UTF8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> digest <span class="token operator">=</span> <span class="token class-name">HmacCoder</span><span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> secretKey<span class="token punctuation">,</span> <span class="token class-name">HmacTypeEn</span><span class="token punctuation">.</span><span class="token class-name">HmacSHA256</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;тјЪТќЄ: &quot;</span> <span class="token operator">+</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ТЉўУдЂ: &quot;</span> <span class="token operator">+</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">encodeBase64URLSafeString</span><span class="token punctuation">(</span>digest<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>УЙЊтЄ║</strong></p> <div class="language- extra-class"><pre class="language-text"><code>тјЪТќЄ:Hello World!
ТЉўУдЂ: b8-eUifaOJ5OUFweOoq08HbGAMsIpC3Nt-Yv-S91Yr4
</code></pre></div><h2 id="ТЋ░тГЌуГЙтљЇ"><a href="#ТЋ░тГЌуГЙтљЇ" class="header-anchor">#</a> ТЋ░тГЌуГЙтљЇ</h2> <h3 id="у«ЌТ│Ћу«ђУ┐░-5"><a href="#у«ЌТ│Ћу«ђУ┐░-5" class="header-anchor">#</a> у«ЌТ│Ћу«ђУ┐░</h3> <p>ТЋ░тГЌуГЙтљЇу«ЌТ│ЋтЈ»С╗ЦуюІтЂџТў»СИђуДЇтИдТюЅт»єжњЦуџёТХѕТЂ»ТЉўУдЂу«ЌТ│Ћ№╝їт╣ХСИћУ┐ЎуДЇт»єжњЦтїЁтљФС║єтЁгжњЦтњїуДЂжњЦсђѓС╣Ът░▒Тў»У»┤№╝їТЋ░тГЌуГЙтљЇу«ЌТ│ЋТў»жЮът»╣уД░тіат»єу«ЌТ│ЋтњїТХѕТЂ»ТЉўУдЂу«ЌТ│Ћуџёу╗ЊтљѕСйЊсђѓ</p> <h4 id="уЅ╣уѓ╣-4"><a href="#уЅ╣уѓ╣-4" class="header-anchor">#</a> уЅ╣уѓ╣</h4> <p>ТЋ░тГЌуГЙтљЇу«ЌТ│ЋУдЂТ▒ѓУЃйтцЪжфїУ»ЂТЋ░ТЇ«т«їТЋ┤ТђДсђЂУ«цУ»ЂТЋ░ТЇ«ТЮЦТ║љ№╝їт╣ХУхитѕ░ТіЌтљдУ«цуџёСйюућесђѓ</p> <h4 id="тјЪуљє-5"><a href="#тјЪуљє-5" class="header-anchor">#</a> тјЪуљє</h4> <p>ТЋ░тГЌуГЙтљЇу«ЌТ│ЋтїЁтљФуГЙтљЇтњїжфїУ»ЂСИцжА╣ТЊЇСйю№╝їжЂхтЙфуДЂжњЦуГЙтљЇ№╝їтЁгжњЦжфїУ»ЂуџёТќ╣т╝Јсђѓ</p> <p>уГЙтљЇТЌХУдЂСй┐ућеуДЂжњЦтњїтЙЁуГЙтљЇТЋ░ТЇ«№╝їжфїУ»ЂТЌХтѕЎжюђУдЂтЁгжњЦсђЂуГЙтљЇтђ╝тњїтЙЁуГЙтљЇТЋ░ТЇ«№╝їтЁХТаИт┐Ѓу«ЌТ│ЋСИ╗УдЂТў»ТХѕТЂ»ТЉўУдЂу«ЌТ│Ћсђѓ</p> <p><img src="http://dunwu.test.upcdn.net/cs/java/advanced/java-message-digest-process.jpg!zp" alt="img"></p> <h4 id="тИИућеу«ЌТ│Ћ-4"><a href="#тИИућеу«ЌТ│Ћ-4" class="header-anchor">#</a> тИИућеу«ЌТ│Ћ</h4> <p>RSAсђЂDSAсђЂECDSA</p> <h3 id="у«ЌТ│Ћт«ъуј░-5"><a href="#у«ЌТ│Ћт«ъуј░-5" class="header-anchor">#</a> у«ЌТ│Ћт«ъуј░</h3> <h4 id="dsa-уџёУїЃСЙІ"><a href="#dsa-уџёУїЃСЙІ" class="header-anchor">#</a> DSA уџёУїЃСЙІ</h4> <p>ТЋ░тГЌуГЙтљЇТюЅСИцСИфТхЂуеІ№╝џуГЙтљЇтњїжфїУ»Ђсђѓ</p> <p>т«ЃС╗гуџётЅЇТЈљжЃйТў»УдЂТюЅСИђСИфтЁгжњЦсђЂт»єжњЦт»╣сђѓ</p> <p><strong>уГЙтљЇ</strong></p> <p>ућеуДЂжњЦСИ║ТХѕТЂ»У«Ау«ЌуГЙтљЇ</p> <p><strong>УїЃСЙІ</strong></p> <p>ућетЁгжњЦжфїУ»ЂТЉўУдЂ</p> <div class="language-java extra-class"><pre class="language-java"><code>importjava<span class="token punctuation">.</span>security<span class="token punctuation">.</span><span class="token class-name">KeyFactory</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>security</span><span class="token punctuation">.</span><span class="token class-name">KeyPair</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>security</span><span class="token punctuation">.</span><span class="token class-name">KeyPairGenerator</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>security</span><span class="token punctuation">.</span><span class="token class-name">PrivateKey</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>security</span><span class="token punctuation">.</span><span class="token class-name">PublicKey</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>security</span><span class="token punctuation">.</span><span class="token class-name">Signature</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>security<span class="token punctuation">.</span>spec</span><span class="token punctuation">.</span><span class="token class-name">PKCS8EncodedKeySpec</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>security<span class="token punctuation">.</span>spec</span><span class="token punctuation">.</span><span class="token class-name">X509EncodedKeySpec</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>codec<span class="token punctuation">.</span>binary</span><span class="token punctuation">.</span><span class="token class-name">Base64</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DsaCoder</span><span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> KEY_ALGORITHM <span class="token operator">=</span> <span class="token string">&quot;DSA&quot;</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">DsaTypeEn</span> <span class="token punctuation">{</span>
        <span class="token class-name">MD5withDSA</span><span class="token punctuation">,</span> <span class="token class-name">SHA1withDSA</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * DSAт»єжњЦжЋ┐т║дж╗ўУ«ц1024СйЇсђѓ т»єжњЦжЋ┐т║дт┐ЁжА╗Тў»64уџёТЋ┤ТЋ░тђЇ№╝їУїЃтЏ┤тюе512~1024С╣ІжЌ┤
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> KEY_SIZE <span class="token operator">=</span> <span class="token number">1024</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">KeyPair</span> keyPair<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">DsaCoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        keyPair <span class="token operator">=</span> <span class="token function">initKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">signature</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> data<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> privateKey<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">PKCS8EncodedKeySpec</span> keySpec <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PKCS8EncodedKeySpec</span><span class="token punctuation">(</span>privateKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">KeyFactory</span> keyFactory <span class="token operator">=</span> <span class="token class-name">KeyFactory</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>KEY_ALGORITHM<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PrivateKey</span> key <span class="token operator">=</span>keyFactory<span class="token punctuation">.</span><span class="token function">generatePrivate</span><span class="token punctuation">(</span>keySpec<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Signature</span> signature <span class="token operator">=</span> <span class="token class-name">Signature</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token class-name">DsaTypeEn</span><span class="token punctuation">.</span><span class="token class-name">SHA1withDSA</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        signature<span class="token punctuation">.</span><span class="token function">initSign</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        signature<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> signature<span class="token punctuation">.</span><span class="token function">sign</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">verify</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> data<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> publicKey<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> sign<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">X509EncodedKeySpec</span> keySpec <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">X509EncodedKeySpec</span><span class="token punctuation">(</span>publicKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">KeyFactory</span> keyFactory <span class="token operator">=</span> <span class="token class-name">KeyFactory</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>KEY_ALGORITHM<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PublicKey</span> key <span class="token operator">=</span>keyFactory<span class="token punctuation">.</span><span class="token function">generatePublic</span><span class="token punctuation">(</span>keySpec<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Signature</span> signature <span class="token operator">=</span> <span class="token class-name">Signature</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token class-name">DsaTypeEn</span><span class="token punctuation">.</span><span class="token class-name">SHA1withDSA</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        signature<span class="token punctuation">.</span><span class="token function">initVerify</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        signature<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> signature<span class="token punctuation">.</span><span class="token function">verify</span><span class="token punctuation">(</span>sign<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token class-name">KeyPair</span> <span class="token function">initKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">// тѕЮтДІтїќт»єжњЦт»╣ућЪТѕљтЎе</span>
        <span class="token class-name">KeyPairGenerator</span> keyPairGen <span class="token operator">=</span> <span class="token class-name">KeyPairGenerator</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span>KEY_ALGORITHM<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// т«ъСЙІтїќт»єжњЦт»╣ућЪТѕљтЎе</span>
        keyPairGen<span class="token punctuation">.</span><span class="token function">initialize</span><span class="token punctuation">(</span>KEY_SIZE<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// т«ъСЙІтїќт»єжњЦт»╣</span>
        <span class="token keyword">return</span> keyPairGen<span class="token punctuation">.</span><span class="token function">genKeyPair</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getPublicKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> keyPair<span class="token punctuation">.</span><span class="token function">getPublic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getEncoded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getPrivateKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> keyPair<span class="token punctuation">.</span><span class="token function">getPrivate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getEncoded</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> msg <span class="token operator">=</span> <span class="token string">&quot;Hello World&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">DsaCoder</span> dsa <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DsaCoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> sign <span class="token operator">=</span> dsa<span class="token punctuation">.</span><span class="token function">signature</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dsa<span class="token punctuation">.</span><span class="token function">getPrivateKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">boolean</span> flag <span class="token operator">=</span> dsa<span class="token punctuation">.</span><span class="token function">verify</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dsa<span class="token punctuation">.</span><span class="token function">getPublicKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sign<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> result <span class="token operator">=</span> flag <span class="token operator">?</span> <span class="token string">&quot;ТЋ░тГЌуГЙтљЇтї╣жЁЇ&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;ТЋ░тГЌуГЙтљЇСИЇтї╣жЁЇ&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ТЋ░тГЌуГЙтљЇ№╝џ&quot;</span> <span class="token operator">+</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">encodeBase64URLSafeString</span><span class="token punctuation">(</span>sign<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;жфїУ»Ђу╗ЊТъю№╝џ&quot;</span> <span class="token operator">+</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="тЈѓУђЃУхёТќЎ"><a href="#тЈѓУђЃУхёТќЎ" class="header-anchor">#</a> тЈѓУђЃУхёТќЎ</h2> <ul><li>сђіCore Java Volume2сђІ</li> <li>сђіJava тіат»єСИјУДБт»єТіђТю»сђІ</li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/dunwu/javacore/edit/master/docs/advanced/java-crypto.md" target="_blank" rel="noopener noreferrer">тИ«тіЕТѕЉС╗гТћ╣тќёТГцжАхжЮб№╝Ђ</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <!----> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/javacore/assets/js/app.3de50782.js" defer></script><script src="/javacore/assets/js/4.13456b84.js" defer></script><script src="/javacore/assets/js/11.350d5fe0.js" defer></script><script src="/javacore/assets/js/5.65836544.js" defer></script>
  </body>
</html>
