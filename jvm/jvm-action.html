<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>JVM 实战 | JAVACORE</title>
    <meta name="description" content="Java 教程">
    <meta name="generator" content="VuePress 1.3.1">
    <link rel="icon" href="/javacore/favicon.ico">
    
    <link rel="preload" href="/javacore/assets/css/0.styles.e9d65cce.css" as="style"><link rel="preload" href="/javacore/assets/js/app.3de50782.js" as="script"><link rel="preload" href="/javacore/assets/js/4.13456b84.js" as="script"><link rel="preload" href="/javacore/assets/js/54.5410b72b.js" as="script"><link rel="preload" href="/javacore/assets/js/5.65836544.js" as="script"><link rel="prefetch" href="/javacore/assets/js/10.8c899971.js"><link rel="prefetch" href="/javacore/assets/js/11.350d5fe0.js"><link rel="prefetch" href="/javacore/assets/js/12.2199728e.js"><link rel="prefetch" href="/javacore/assets/js/13.967fce6c.js"><link rel="prefetch" href="/javacore/assets/js/14.8275d0bd.js"><link rel="prefetch" href="/javacore/assets/js/15.6a09a144.js"><link rel="prefetch" href="/javacore/assets/js/16.19f02ba1.js"><link rel="prefetch" href="/javacore/assets/js/17.ed1ae7cf.js"><link rel="prefetch" href="/javacore/assets/js/18.9542df9d.js"><link rel="prefetch" href="/javacore/assets/js/19.33815bc9.js"><link rel="prefetch" href="/javacore/assets/js/20.b48a1605.js"><link rel="prefetch" href="/javacore/assets/js/21.84842e19.js"><link rel="prefetch" href="/javacore/assets/js/22.9856136d.js"><link rel="prefetch" href="/javacore/assets/js/23.078a7e69.js"><link rel="prefetch" href="/javacore/assets/js/24.8961f549.js"><link rel="prefetch" href="/javacore/assets/js/25.f5d70f7e.js"><link rel="prefetch" href="/javacore/assets/js/26.adedecef.js"><link rel="prefetch" href="/javacore/assets/js/27.f475d82e.js"><link rel="prefetch" href="/javacore/assets/js/28.3f8ad064.js"><link rel="prefetch" href="/javacore/assets/js/29.b5314d44.js"><link rel="prefetch" href="/javacore/assets/js/30.f0531d6e.js"><link rel="prefetch" href="/javacore/assets/js/31.11f77e70.js"><link rel="prefetch" href="/javacore/assets/js/32.2048c2de.js"><link rel="prefetch" href="/javacore/assets/js/33.ac464a7a.js"><link rel="prefetch" href="/javacore/assets/js/34.41b97081.js"><link rel="prefetch" href="/javacore/assets/js/35.95494b37.js"><link rel="prefetch" href="/javacore/assets/js/36.9eaef114.js"><link rel="prefetch" href="/javacore/assets/js/37.3b4e6b6f.js"><link rel="prefetch" href="/javacore/assets/js/38.8599d9b0.js"><link rel="prefetch" href="/javacore/assets/js/39.143cacbc.js"><link rel="prefetch" href="/javacore/assets/js/40.d1838ae1.js"><link rel="prefetch" href="/javacore/assets/js/41.2fa20809.js"><link rel="prefetch" href="/javacore/assets/js/42.59c1ab82.js"><link rel="prefetch" href="/javacore/assets/js/43.7ef1889c.js"><link rel="prefetch" href="/javacore/assets/js/44.b0f638dd.js"><link rel="prefetch" href="/javacore/assets/js/45.7b50418b.js"><link rel="prefetch" href="/javacore/assets/js/46.e4d1c39f.js"><link rel="prefetch" href="/javacore/assets/js/47.b7cfbd0c.js"><link rel="prefetch" href="/javacore/assets/js/48.e661dc3b.js"><link rel="prefetch" href="/javacore/assets/js/49.8783fd36.js"><link rel="prefetch" href="/javacore/assets/js/50.885a9acc.js"><link rel="prefetch" href="/javacore/assets/js/51.202cb367.js"><link rel="prefetch" href="/javacore/assets/js/52.53409cde.js"><link rel="prefetch" href="/javacore/assets/js/53.400a404c.js"><link rel="prefetch" href="/javacore/assets/js/55.c904afaa.js"><link rel="prefetch" href="/javacore/assets/js/56.2b2538de.js"><link rel="prefetch" href="/javacore/assets/js/57.cae5cfaf.js"><link rel="prefetch" href="/javacore/assets/js/58.3a2e559c.js"><link rel="prefetch" href="/javacore/assets/js/59.2464138f.js"><link rel="prefetch" href="/javacore/assets/js/6.76e266d6.js"><link rel="prefetch" href="/javacore/assets/js/60.7dc4947f.js"><link rel="prefetch" href="/javacore/assets/js/61.4da8e90f.js"><link rel="prefetch" href="/javacore/assets/js/62.6c617e5b.js"><link rel="prefetch" href="/javacore/assets/js/7.477def74.js"><link rel="prefetch" href="/javacore/assets/js/8.7e86464c.js"><link rel="prefetch" href="/javacore/assets/js/9.9c34e164.js"><link rel="prefetch" href="/javacore/assets/js/vendors~flowchart.184dd07e.js"><link rel="prefetch" href="/javacore/assets/js/vendors~notification.de05f6a9.js">
    <link rel="stylesheet" href="/javacore/assets/css/0.styles.e9d65cce.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/javacore/" class="home-link router-link-active"><img src="images/dunwu-logo-100.png" alt="JAVACORE" class="logo"> <span class="site-name can-hide">JAVACORE</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/javacore/basics/" class="nav-link">
  基础
</a></div><div class="nav-item"><a href="/javacore/advanced/" class="nav-link">
  高级
</a></div><div class="nav-item"><a href="/javacore/container/" class="nav-link">
  容器
</a></div><div class="nav-item"><a href="/javacore/io/" class="nav-link">
  IO
</a></div><div class="nav-item"><a href="/javacore/concurrent/" class="nav-link">
  并发
</a></div><div class="nav-item"><a href="/javacore/jvm/" class="nav-link router-link-active">
  JVM
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">✨ Java系列</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/java-tutorial/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Java 教程 📚
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/javacore/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  JavaCore 教程 📚
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/javacore/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  JavaTech 教程 📚
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/spring-tutorial/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Spring 教程 📚
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/spring-boot-tutorial/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Spring Boot 教程 📚
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><a href="https://github.com/dunwu/blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  🎯 博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/dunwu/javacore" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/javacore/basics/" class="nav-link">
  基础
</a></div><div class="nav-item"><a href="/javacore/advanced/" class="nav-link">
  高级
</a></div><div class="nav-item"><a href="/javacore/container/" class="nav-link">
  容器
</a></div><div class="nav-item"><a href="/javacore/io/" class="nav-link">
  IO
</a></div><div class="nav-item"><a href="/javacore/concurrent/" class="nav-link">
  并发
</a></div><div class="nav-item"><a href="/javacore/jvm/" class="nav-link router-link-active">
  JVM
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">✨ Java系列</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/java-tutorial/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Java 教程 📚
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/javacore/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  JavaCore 教程 📚
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/javacore/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  JavaTech 教程 📚
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/spring-tutorial/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Spring 教程 📚
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://dunwu.github.io/spring-boot-tutorial/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Spring Boot 教程 📚
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><a href="https://github.com/dunwu/blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  🎯 博客
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/dunwu/javacore" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>JVM 实战</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/javacore/jvm/jvm-action.html#jvm-调优概述" class="sidebar-link">JVM 调优概述</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/javacore/jvm/jvm-action.html#性能定义" class="sidebar-link">性能定义</a></li><li class="sidebar-sub-header"><a href="/javacore/jvm/jvm-action.html#调优原则" class="sidebar-link">调优原则</a></li><li class="sidebar-sub-header"><a href="/javacore/jvm/jvm-action.html#gc-优化的过程" class="sidebar-link">GC 优化的过程</a></li></ul></li><li><a href="/javacore/jvm/jvm-action.html#hotspot-vm-参数" class="sidebar-link">HotSpot VM 参数</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/javacore/jvm/jvm-action.html#jvm-内存配置" class="sidebar-link">JVM 内存配置</a></li><li class="sidebar-sub-header"><a href="/javacore/jvm/jvm-action.html#gc-类型配置" class="sidebar-link">GC 类型配置</a></li><li class="sidebar-sub-header"><a href="/javacore/jvm/jvm-action.html#垃圾回收器通用参数" class="sidebar-link">垃圾回收器通用参数</a></li><li class="sidebar-sub-header"><a href="/javacore/jvm/jvm-action.html#jmx" class="sidebar-link">JMX</a></li><li class="sidebar-sub-header"><a href="/javacore/jvm/jvm-action.html#远程-debug" class="sidebar-link">远程 DEBUG</a></li><li class="sidebar-sub-header"><a href="/javacore/jvm/jvm-action.html#heapdump" class="sidebar-link">HeapDump</a></li><li class="sidebar-sub-header"><a href="/javacore/jvm/jvm-action.html#辅助配置" class="sidebar-link">辅助配置</a></li></ul></li><li><a href="/javacore/jvm/jvm-action.html#典型配置" class="sidebar-link">典型配置</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/javacore/jvm/jvm-action.html#堆大小设置" class="sidebar-link">堆大小设置</a></li><li class="sidebar-sub-header"><a href="/javacore/jvm/jvm-action.html#回收器选择" class="sidebar-link">回收器选择</a></li></ul></li><li><a href="/javacore/jvm/jvm-action.html#分析-gc-日志" class="sidebar-link">分析 GC 日志</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/javacore/jvm/jvm-action.html#获取-gc-日志" class="sidebar-link">获取 GC 日志</a></li><li class="sidebar-sub-header"><a href="/javacore/jvm/jvm-action.html#如何分析-gc-日志" class="sidebar-link">如何分析 GC 日志</a></li><li class="sidebar-sub-header"><a href="/javacore/jvm/jvm-action.html#如何分析-outofmemory-oom" class="sidebar-link">如何分析 OutOfMemory(OOM)</a></li></ul></li><li><a href="/javacore/jvm/jvm-action.html#参考资料" class="sidebar-link">参考资料</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="jvm-实战"><a href="#jvm-实战" class="header-anchor">#</a> JVM 实战</h1> <blockquote><p><strong>📦 本文以及示例源码已归档在 <a href="https://github.com/dunwu/javacore/" target="_blank" rel="noopener noreferrer">javacore<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></strong></p></blockquote> <h2 id="jvm-调优概述"><a href="#jvm-调优概述" class="header-anchor">#</a> JVM 调优概述</h2> <h3 id="性能定义"><a href="#性能定义" class="header-anchor">#</a> 性能定义</h3> <ul><li><code>吞吐量</code> - 指不考虑 GC 引起的停顿时间或内存消耗，垃圾收集器能支撑应用达到的最高性能指标。</li> <li><code>延迟</code> - 其度量标准是缩短由于垃圾啊收集引起的停顿时间或者完全消除因垃圾收集所引起的停顿，避免应用运行时发生抖动。</li> <li><code>内存占用</code> - 垃圾收集器流畅运行所需要的内存数量。</li></ul> <h3 id="调优原则"><a href="#调优原则" class="header-anchor">#</a> 调优原则</h3> <h4 id="gc-优化目标"><a href="#gc-优化目标" class="header-anchor">#</a> GC 优化目标</h4> <p>GC 优化的两个目标：</p> <ol><li><strong>将进入老年代的对象数量降到最低</strong></li> <li><strong>减少 Full GC 的执行时间</strong></li></ol> <p>GC 优化的基本原则是：将不同的 GC 参数应用到两个及以上的服务器上然后比较它们的性能，然后将那些被证明可以提高性能或减少 GC 执行时间的参数应用于最终的工作服务器上。</p> <h4 id="将进入老年代的对象数量降到最低"><a href="#将进入老年代的对象数量降到最低" class="header-anchor">#</a> 将进入老年代的对象数量降到最低</h4> <p>除了可以在 JDK7 及更高版本中使用的 G1 收集器以外，其他分代 GC 都是由 Oracle JVM 提供的。关于分代 GC，就是对象在 Eden 区被创建，随后被转移到 Survivor 区，在此之后剩余的对象会被转入老年代。也有一些对象由于占用内存过大，在 Eden 区被创建后会直接被传入老年代。老年代 GC 相对来说会比新生代 GC 更耗时，因此，减少进入老年代的对象数量可以显著降低 Full GC 的频率。你可能会以为减少进入老年代的对象数量意味着把它们留在新生代，事实正好相反，新生代内存的大小是可以调节的。</p> <h4 id="降低-full-gc-的时间"><a href="#降低-full-gc-的时间" class="header-anchor">#</a> 降低 Full GC 的时间</h4> <p>Full GC 的执行时间比 Minor GC 要长很多，因此，如果在 Full GC 上花费过多的时间（超过 1s），将可能出现超时错误。</p> <ul><li>如果<strong>通过减小老年代内存来减少 Full GC 时间</strong>，可能会引起 <code>OutOfMemoryError</code> 或者导致 Full GC 的频率升高。</li> <li>另外，如果<strong>通过增加老年代内存来降低 Full GC 的频率</strong>，Full GC 的时间可能因此增加。</li></ul> <p>因此，你<strong>需要把老年代的大小设置成一个“合适”的值</strong>。</p> <p><strong>GC 优化需要考虑的 JVM 参数</strong></p> <table><thead><tr><th><strong>类型</strong></th> <th><strong>参数</strong></th> <th><strong>描述</strong></th></tr></thead> <tbody><tr><td>堆内存大小</td> <td><code>-Xms</code></td> <td>启动 JVM 时堆内存的大小</td></tr> <tr><td></td> <td><code>-Xmx</code></td> <td>堆内存最大限制</td></tr> <tr><td>新生代空间大小</td> <td><code>-XX:NewRatio</code></td> <td>新生代和老年代的内存比</td></tr> <tr><td></td> <td><code>-XX:NewSize</code></td> <td>新生代内存大小</td></tr> <tr><td></td> <td><code>-XX:SurvivorRatio</code></td> <td>Eden 区和 Survivor 区的内存比</td></tr></tbody></table> <p>GC 优化时最常用的参数是<code>-Xms</code>,<code>-Xmx</code>和<code>-XX:NewRatio</code>。<code>-Xms</code>和<code>-Xmx</code>参数通常是必须的，所以<code>NewRatio</code>的值将对 GC 性能产生重要的影响。</p> <p>有些人可能会问<strong>如何设置永久代内存大小</strong>，你可以用<code>-XX:PermSize</code>和<code>-XX:MaxPermSize</code>参数来进行设置，但是要记住，只有当出现<code>OutOfMemoryError</code>错误时你才需要去设置永久代内存。</p> <h3 id="gc-优化的过程"><a href="#gc-优化的过程" class="header-anchor">#</a> GC 优化的过程</h3> <p>GC 优化的过程和大多数常见的提升性能的过程相似，下面是笔者使用的流程：</p> <h4 id="_1-监控-gc-状态"><a href="#_1-监控-gc-状态" class="header-anchor">#</a> 1.监控 GC 状态</h4> <p>你需要监控 GC 从而检查系统中运行的 GC 的各种状态。</p> <h4 id="_2-分析监控结果后决定是否需要优化-gc"><a href="#_2-分析监控结果后决定是否需要优化-gc" class="header-anchor">#</a> 2.分析监控结果后决定是否需要优化 GC</h4> <p>在检查 GC 状态后，你需要分析监控结构并决定是否需要进行 GC 优化。如果分析结果显示运行 GC 的时间只有 0.1-0.3 秒，那么就不需要把时间浪费在 GC 优化上，但如果运行 GC 的时间达到 1-3 秒，甚至大于 10 秒，那么 GC 优化将是很有必要的。</p> <p>但是，如果你已经分配了大约 10GB 内存给 Java，并且这些内存无法省下，那么就无法进行 GC 优化了。在进行 GC 优化之前，你需要考虑为什么你需要分配这么大的内存空间，如果你分配了 1GB 或 2GB 大小的内存并且出现了<code>OutOfMemoryError</code>，那你就应该执行**堆快照（heap dump）**来消除导致异常的原因。</p> <blockquote><p>🔔 注意：</p></blockquote> <blockquote><p>**堆快照（heap dump）**是一个用来检查 Java 内存中的对象和数据的内存文件。该文件可以通过执行 JDK 中的<code>jmap</code>命令来创建。在创建文件的过程中，所有 Java 程序都将暂停，因此，不要在系统执行过程中创建该文件。</p></blockquote> <blockquote><p>你可以在互联网上搜索 heap dump 的详细说明。</p></blockquote> <h4 id="_3-设置-gc-类型-内存大小"><a href="#_3-设置-gc-类型-内存大小" class="header-anchor">#</a> 3.设置 GC 类型/内存大小</h4> <p>如果你决定要进行 GC 优化，那么你需要选择一个 GC 类型并且为它设置内存大小。此时如果你有多个服务器，请如上文提到的那样，在每台机器上设置不同的 GC 参数并分析它们的区别。</p> <h4 id="_4-分析结果"><a href="#_4-分析结果" class="header-anchor">#</a> 4.分析结果</h4> <p>在设置完 GC 参数后就可以开始收集数据，请在收集至少 24 小时后再进行结果分析。如果你足够幸运，你可能会找到系统的最佳 GC 参数。如若不然，你还需要分析输出日志并检查分配的内存，然后需要通过不断调整 GC 类型/内存大小来找到系统的最佳参数。</p> <h4 id="_5-如果结果令人满意，将参数应用到所有服务器上并结束-gc-优化"><a href="#_5-如果结果令人满意，将参数应用到所有服务器上并结束-gc-优化" class="header-anchor">#</a> 5.如果结果令人满意，将参数应用到所有服务器上并结束 GC 优化</h4> <p>如果 GC 优化的结果令人满意，就可以将参数应用到所有服务器上，并停止 GC 优化。</p> <p>在下面的章节中，你将会看到上述每一步所做的具体工作。</p> <h2 id="hotspot-vm-参数"><a href="#hotspot-vm-参数" class="header-anchor">#</a> HotSpot VM 参数</h2> <blockquote><p>详细参数说明请参考官方文档：<a href="http://www.oracle.com/technetwork/java/javase/tech/vmoptions-jsp-140102.html" target="_blank" rel="noopener noreferrer">JavaHotSpot VM Options<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，这里仅列举常用参数。</p></blockquote> <h3 id="jvm-内存配置"><a href="#jvm-内存配置" class="header-anchor">#</a> JVM 内存配置</h3> <table><thead><tr><th>配置</th> <th>描述</th></tr></thead> <tbody><tr><td><code>-Xms</code></td> <td>堆空间初始值。</td></tr> <tr><td><code>-Xmx</code></td> <td>堆空间最大值。</td></tr> <tr><td><code>-Xmn</code></td> <td>新生代空间大小。</td></tr> <tr><td><code>-Xss</code></td> <td>虚拟机栈大小。</td></tr> <tr><td><code>-XX:NewSize</code></td> <td>新生代空间初始值。</td></tr> <tr><td><code>-XX:MaxNewSize</code></td> <td>新生代空间最大值。</td></tr> <tr><td><code>-XX:PermSize</code></td> <td>永久代空间的初始值。</td></tr> <tr><td><code>-XX:MaxPermSize</code></td> <td>永久代空间的最大值。</td></tr> <tr><td><code>NewRatio</code></td> <td>新生代与年老代的比例。</td></tr> <tr><td><code>SurvivorRatio</code></td> <td>新生代中调整 eden 区与 survivor 区的比例，默认为 8。即 eden 区为 80%的大小，两个 survivor 分别为 10% 的大小。</td></tr></tbody></table> <h3 id="gc-类型配置"><a href="#gc-类型配置" class="header-anchor">#</a> GC 类型配置</h3> <table><thead><tr><th>配置</th> <th>描述</th></tr></thead> <tbody><tr><td><code>-XX:+UseSerialGC</code></td> <td>使用 Serial + Serial Old 垃圾回收器组合</td></tr> <tr><td><code>-XX:+UseParallelGC</code></td> <td>使用 Parallel Scavenge + Parallel Old 垃圾回收器组合</td></tr> <tr><td><s><code>-XX:+UseParallelOldGC</code></s></td> <td><s>使用 Parallel Old 垃圾回收器（JDK5 后已无用）</s></td></tr> <tr><td><code>-XX:+UseParNewGC</code></td> <td>使用 ParNew + Serial Old 垃圾回收器</td></tr> <tr><td><code>-XX:+UseConcMarkSweepGC</code></td> <td>使用 CMS + ParNew + Serial Old 垃圾回收器组合</td></tr> <tr><td><code>-XX:+UseG1GC</code></td> <td>使用 G1 垃圾回收器</td></tr> <tr><td><code>-XX:ParallelCMSThreads</code></td> <td>并发标记扫描垃圾回收器 = 为使用的线程数量</td></tr></tbody></table> <h3 id="垃圾回收器通用参数"><a href="#垃圾回收器通用参数" class="header-anchor">#</a> 垃圾回收器通用参数</h3> <table><thead><tr><th>配置</th> <th>描述</th></tr></thead> <tbody><tr><td><code>PretenureSizeThreshold</code></td> <td>晋升年老代的对象大小。默认为0。比如设为10M，则超过10M的对象将不在eden区分配，而直接进入年老代。</td></tr> <tr><td><code>MaxTenuringThreshold</code></td> <td>晋升老年代的最大年龄。默认为15。比如设为10，则对象在10次普通GC后将会被放入年老代。</td></tr> <tr><td><code>DisableExplicitGC</code></td> <td>禁用 <code>System.gc()</code></td></tr></tbody></table> <h3 id="jmx"><a href="#jmx" class="header-anchor">#</a> JMX</h3> <p>开启 JMX 后，可以使用 <code>jconsole</code> 或 <code>jvisualvm</code> 进行监控 Java 程序的基本信息和运行情况。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token operator">-</span><span class="token class-name">Dcom</span><span class="token punctuation">.</span>sun<span class="token punctuation">.</span>management<span class="token punctuation">.</span>jmxremote<span class="token operator">=</span><span class="token boolean">true</span>
<span class="token operator">-</span><span class="token class-name">Dcom</span><span class="token punctuation">.</span>sun<span class="token punctuation">.</span>management<span class="token punctuation">.</span>jmxremote<span class="token punctuation">.</span>ssl<span class="token operator">=</span><span class="token boolean">false</span>
<span class="token operator">-</span><span class="token class-name">Dcom</span><span class="token punctuation">.</span>sun<span class="token punctuation">.</span>management<span class="token punctuation">.</span>jmxremote<span class="token punctuation">.</span>authenticate<span class="token operator">=</span><span class="token boolean">false</span>
<span class="token operator">-</span><span class="token class-name">Djava</span><span class="token punctuation">.</span>rmi<span class="token punctuation">.</span>server<span class="token punctuation">.</span>hostname<span class="token operator">=</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>
<span class="token operator">-</span><span class="token class-name">Dcom</span><span class="token punctuation">.</span>sun<span class="token punctuation">.</span>management<span class="token punctuation">.</span>jmxremote<span class="token punctuation">.</span>port<span class="token operator">=</span><span class="token number">18888</span>
</code></pre></div><p><code>-Djava.rmi.server.hostname</code> 指定 Java 程序运行的服务器，<code>-Dcom.sun.management.jmxremote.port</code> 指定服务监听端口。</p> <h3 id="远程-debug"><a href="#远程-debug" class="header-anchor">#</a> 远程 DEBUG</h3> <p>如果开启 Java 应用的远程 Debug 功能，需要指定如下参数：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token operator">-</span><span class="token class-name">Xdebug</span>
<span class="token operator">-</span><span class="token class-name">Xnoagent</span>
<span class="token operator">-</span><span class="token class-name">Djava</span><span class="token punctuation">.</span>compiler<span class="token operator">=</span>NONE
<span class="token operator">-</span><span class="token class-name">Xrunjdwp</span><span class="token operator">:</span>transport<span class="token operator">=</span>dt_socket<span class="token punctuation">,</span>address<span class="token operator">=</span><span class="token number">28888</span><span class="token punctuation">,</span>server<span class="token operator">=</span>y<span class="token punctuation">,</span>suspend<span class="token operator">=</span>n
</code></pre></div><p>address 即为远程 debug 的监听端口。</p> <h3 id="heapdump"><a href="#heapdump" class="header-anchor">#</a> HeapDump</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token operator">-</span>XX<span class="token operator">:</span><span class="token operator">-</span><span class="token class-name">OmitStackTraceInFastThrow</span> <span class="token operator">-</span>XX<span class="token operator">:</span><span class="token operator">+</span><span class="token class-name">HeapDumpOnOutOfMemoryError</span>
</code></pre></div><h3 id="辅助配置"><a href="#辅助配置" class="header-anchor">#</a> 辅助配置</h3> <table><thead><tr><th>配置</th> <th>描述</th></tr></thead> <tbody><tr><td><code>-XX:+PrintGCDetails</code></td> <td>打印 GC 日志</td></tr> <tr><td><code>-Xloggc:&lt;filename&gt;</code></td> <td>指定 GC 日志文件名</td></tr> <tr><td><code>-XX:+HeapDumpOnOutOfMemoryError</code></td> <td>内存溢出时输出堆快照文件</td></tr></tbody></table> <h2 id="典型配置"><a href="#典型配置" class="header-anchor">#</a> 典型配置</h2> <h3 id="堆大小设置"><a href="#堆大小设置" class="header-anchor">#</a> 堆大小设置</h3> <p><strong>年轻代的设置很关键。</strong></p> <p>JVM 中最大堆大小有三方面限制：</p> <ol><li>相关操作系统的数据模型（32-bt 还是 64-bit）限制；</li> <li>系统的可用虚拟内存限制；</li> <li>系统的可用物理内存限制。</li></ol> <div class="language- extra-class"><pre class="language-text"><code>整个堆大小 = 年轻代大小 + 年老代大小 + 持久代大小
</code></pre></div><ul><li>持久代一般固定大小为 64m。使用 <code>-XX:PermSize</code> 设置。</li> <li>官方推荐年轻代占整个堆的 3/8。使用 <code>-Xmn</code> 设置。</li></ul> <h3 id="回收器选择"><a href="#回收器选择" class="header-anchor">#</a> 回收器选择</h3> <p>JVM 给了三种选择：串行收集器、并行收集器、并发收集器。</p> <h2 id="分析-gc-日志"><a href="#分析-gc-日志" class="header-anchor">#</a> 分析 GC 日志</h2> <h3 id="获取-gc-日志"><a href="#获取-gc-日志" class="header-anchor">#</a> 获取 GC 日志</h3> <p>获取 GC 日志有两种方式：</p> <ul><li>使用命令动态查看</li> <li>在容器中设置相关参数打印 GC 日志</li></ul> <p><code>jstat -gc</code> 统计垃圾回收堆的行为：</p> <div class="language-java extra-class"><pre class="language-java"><code>jstat <span class="token operator">-</span>gc <span class="token number">1262</span>
 S0C    S1C     S0U     S1U   EC       EU        OC         OU        PC       PU         YGC    YGCT    FGC    FGCT     GCT
<span class="token number">26112.0</span> <span class="token number">24064.0</span> <span class="token number">6562.5</span>  <span class="token number">0.0</span>   <span class="token number">564224.0</span> <span class="token number">76274.5</span>   <span class="token number">434176.0</span>   <span class="token number">388518.3</span>  <span class="token number">524288.0</span> <span class="token number">42724.7</span>    <span class="token number">320</span>    <span class="token number">6.417</span>   <span class="token number">1</span>      <span class="token number">0.398</span>    <span class="token number">6.815</span>
</code></pre></div><p>也可以设置间隔固定时间来打印：</p> <div class="language-shell extra-class"><pre class="language-shell"><code>jstat -gc <span class="token number">1262</span> <span class="token number">2000</span> <span class="token number">20</span>
</code></pre></div><p>这个命令意思就是每隔 2000ms 输出 1262 的 gc 情况，一共输出 20 次</p> <p>Tomcat 设置示例：</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token assign-left variable">JAVA_OPTS</span><span class="token operator">=</span><span class="token string">&quot;-server -Xms2000m -Xmx2000m -Xmn800m -XX:PermSize=64m -XX:MaxPermSize=256m -XX:SurvivorRatio=4
-verbose:gc -Xloggc:<span class="token variable">$CATALINA_HOME</span>/logs/gc.log
-Djava.awt.headless=true
-XX:+PrintGCTimeStamps -XX:+PrintGCDetails
-Dsun.rmi.dgc.server.gcInterval=600000 -Dsun.rmi.dgc.client.gcInterval=600000
-XX:+UseConcMarkSweepGC -XX:MaxTenuringThreshold=15&quot;</span>
</code></pre></div><ul><li><code>-Xms2000m -Xmx2000m -Xmn800m -XX:PermSize=64m -XX:MaxPermSize=256m</code>
Xms，即为 jvm 启动时得 JVM 初始堆大小,Xmx 为 jvm 的最大堆大小，xmn 为新生代的大小，permsize 为永久代的初始大小，MaxPermSize 为永久代的最大空间。</li> <li><code>-XX:SurvivorRatio=4</code>
SurvivorRatio 为新生代空间中的 Eden 区和救助空间 Survivor 区的大小比值，默认是 8，则两个 Survivor 区与一个 Eden 区的比值为 2:8,一个 Survivor 区占整个年轻代的 1/10。调小这个参数将增大 survivor 区，让对象尽量在 survitor 区呆长一点，减少进入年老代的对象。去掉救助空间的想法是让大部分不能马上回收的数据尽快进入年老代，加快年老代的回收频率，减少年老代暴涨的可能性，这个是通过将-XX:SurvivorRatio 设置成比较大的值（比如 65536)来做到。</li> <li><code>-verbose:gc -Xloggc:$CATALINA_HOME/logs/gc.log</code>
将虚拟机每次垃圾回收的信息写到日志文件中，文件名由 file 指定，文件格式是平文件，内容和-verbose:gc 输出内容相同。</li> <li><code>-Djava.awt.headless=true</code> Headless 模式是系统的一种配置模式。在该模式下，系统缺少了显示设备、键盘或鼠标。</li> <li><code>-XX:+PrintGCTimeStamps -XX:+PrintGCDetails</code>
设置 gc 日志的格式</li> <li><code>-Dsun.rmi.dgc.server.gcInterval=600000 -Dsun.rmi.dgc.client.gcInterval=600000</code>
指定 rmi 调用时 gc 的时间间隔</li> <li><code>-XX:+UseConcMarkSweepGC -XX:MaxTenuringThreshold=15</code> 采用并发 gc 方式，经过 15 次 minor gc 后进入年老代</li></ul> <h3 id="如何分析-gc-日志"><a href="#如何分析-gc-日志" class="header-anchor">#</a> 如何分析 GC 日志</h3> <p>Young GC 回收日志:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token number">2016</span><span class="token operator">-</span><span class="token number">07</span><span class="token operator">-</span><span class="token number">05</span>T10<span class="token operator">:</span><span class="token number">43</span><span class="token operator">:</span><span class="token number">18.093</span><span class="token operator">+</span><span class="token number">0800</span><span class="token operator">:</span> <span class="token number">25.395</span><span class="token operator">:</span> <span class="token punctuation">[</span>GC <span class="token punctuation">[</span><span class="token class-name">PSYoungGen</span><span class="token operator">:</span> <span class="token number">274931</span>K<span class="token operator">-&gt;</span><span class="token function">10738K</span><span class="token punctuation">(</span><span class="token number">274944</span>K<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token number">371093</span>K<span class="token operator">-&gt;</span><span class="token function">147186K</span><span class="token punctuation">(</span><span class="token number">450048</span>K<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0668480</span> secs<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token class-name">Times</span><span class="token operator">:</span> user<span class="token operator">=</span><span class="token number">0.17</span> sys<span class="token operator">=</span><span class="token number">0.08</span><span class="token punctuation">,</span> real<span class="token operator">=</span><span class="token number">0.07</span> secs<span class="token punctuation">]</span>
</code></pre></div><p>Full GC 回收日志:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token number">2016</span><span class="token operator">-</span><span class="token number">07</span><span class="token operator">-</span><span class="token number">05</span>T10<span class="token operator">:</span><span class="token number">43</span><span class="token operator">:</span><span class="token number">18.160</span><span class="token operator">+</span><span class="token number">0800</span><span class="token operator">:</span> <span class="token number">25.462</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token class-name">Full</span> GC <span class="token punctuation">[</span><span class="token class-name">PSYoungGen</span><span class="token operator">:</span> <span class="token number">10738</span>K<span class="token operator">-&gt;</span><span class="token function">0K</span><span class="token punctuation">(</span><span class="token number">274944</span>K<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token class-name">ParOldGen</span><span class="token operator">:</span> <span class="token number">136447</span>K<span class="token operator">-&gt;</span><span class="token function">140379K</span><span class="token punctuation">(</span><span class="token number">302592</span>K<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token number">147186</span>K<span class="token operator">-&gt;</span><span class="token function">140379K</span><span class="token punctuation">(</span><span class="token number">577536</span>K<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token class-name">PSPermGen</span><span class="token operator">:</span> <span class="token number">85411</span>K<span class="token operator">-&gt;</span><span class="token function">85376K</span><span class="token punctuation">(</span><span class="token number">171008</span>K<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0.6763541</span> secs<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token class-name">Times</span><span class="token operator">:</span> user<span class="token operator">=</span><span class="token number">1.75</span> sys<span class="token operator">=</span><span class="token number">0.02</span><span class="token punctuation">,</span> real<span class="token operator">=</span><span class="token number">0.68</span> secs<span class="token punctuation">]</span>
</code></pre></div><p>通过上面日志分析得出，PSYoungGen、ParOldGen、PSPermGen 属于 Parallel 收集器。其中 PSYoungGen 表示 gc 回收前后年轻代的内存变化；ParOldGen 表示 gc 回收前后老年代的内存变化；PSPermGen 表示 gc 回收前后永久区的内存变化。young gc 主要是针对年轻代进行内存回收比较频繁，耗时短；full gc 会对整个堆内存进行回城，耗时长，因此一般尽量减少 full gc 的次数</p> <p>通过两张图非常明显看出 gc 日志构成：</p> <p><img src="http://ityouknow.com/assets/images/2017/jvm/Young%20GC.png" alt="img"></p> <p><img src="http://ityouknow.com/assets/images/2017/jvm/Full%20GC.png" alt="img"></p> <h3 id="如何分析-outofmemory-oom"><a href="#如何分析-outofmemory-oom" class="header-anchor">#</a> 如何分析 OutOfMemory(OOM)</h3> <p>OutOfMemory ，即内存溢出，是一个常见的 JVM 问题。那么分析 OOM 的思路是什么呢？</p> <p>首先，要知道有三种 OutOfMemoryError：</p> <ul><li><strong>OutOfMemoryError:Java heap space</strong> - 堆空间溢出</li> <li><strong>OutOfMemoryError:PermGen space</strong> - 方法区和运行时常量池溢出</li> <li><strong>OutOfMemoryError:unable to create new native thread</strong> - 线程过多</li></ul> <h4 id="outofmemoryerror-permgen-space"><a href="#outofmemoryerror-permgen-space" class="header-anchor">#</a> OutOfMemoryError:PermGen space</h4> <p>OutOfMemoryError:PermGen space 表示方法区和运行时常量池溢出。</p> <p><strong>原因：</strong></p> <p>Perm 区主要用于存放 Class 和 Meta 信息的，Class 在被 Loader 时就会被放到 PermGen space，这个区域称为年老代。GC 在主程序运行期间不会对年老区进行清理，默认是 64M 大小。</p> <p>当程序程序中使用了大量的 jar 或 class，使 java 虚拟机装载类的空间不够，超过 64M 就会报这部分内存溢出了，需要加大内存分配，一般 128m 足够。</p> <p><strong>解决方案：</strong></p> <p>（1）扩大永久代空间</p> <ul><li>JDK7 以前使用 <code>-XX:PermSize</code> 和 <code>-XX:MaxPermSize</code> 来控制永久代大小。</li> <li>JDK8 以后把原本放在永久代的字符串常量池移出, 放在 Java 堆中(元空间 Metaspace)中，元数据并不在虚拟机中，使用的是本地的内存。使用 <code>-XX:MetaspaceSize</code> 和 <code>-XX:MaxMetaspaceSize</code> 控制元空间大小。</li></ul> <blockquote><p>🔔 注意：<code>-XX:PermSize</code> 一般设为 64M</p></blockquote> <p>（2）清理应用程序中 <code>WEB-INF/lib</code> 下的 jar，用不上的 jar 删除掉，多个应用公共的 jar 移动到 Tomcat 的 lib 目录，减少重复加载。</p> <h4 id="outofmemoryerror-java-heap-space"><a href="#outofmemoryerror-java-heap-space" class="header-anchor">#</a> OutOfMemoryError:Java heap space</h4> <p>OutOfMemoryError:Java heap space 表示堆空间溢出。</p> <p>原因：JVM 分配给堆内存的空间已经用满了。</p> <h5 id="问题定位"><a href="#问题定位" class="header-anchor">#</a> 问题定位</h5> <p>（1）使用 jmap 或 -XX:+HeapDumpOnOutOfMemoryError 获取堆快照。
（2）使用内存分析工具（visualvm、mat、jProfile 等）对堆快照文件进行分析。
（3）根据分析图，重点是确认内存中的对象是否是必要的，分清究竟是是内存泄漏（Memory Leak）还是内存溢出（Memory Overflow）。</p> <h6 id="内存泄露"><a href="#内存泄露" class="header-anchor">#</a> 内存泄露</h6> <p>内存泄漏是指由于疏忽或错误造成程序未能释放已经不再使用的内存的情况。</p> <p>内存泄漏并非指内存在物理上的消失，而是应用程序分配某段内存后，由于设计错误，失去了对该段内存的控制，因而造成了内存的浪费。</p> <p>内存泄漏随着被执行的次数越多-最终会导致内存溢出。</p> <p>而因程序死循环导致的不断创建对象-只要被执行到就会产生内存溢出。</p> <p>内存泄漏常见几个情况：</p> <ul><li>静态集合类
<ul><li>声明为静态（static）的 HashMap、Vector 等集合</li> <li>通俗来讲 A 中有 B，当前只把 B 设置为空，A 没有设置为空，回收时 B 无法回收-因被 A 引用。</li></ul></li> <li>监听器
<ul><li>监听器被注册后释放对象时没有删除监听器</li></ul></li> <li>物理连接
<ul><li>DataSource.getConnection()建立链接，必须通过 close()关闭链接</li></ul></li> <li>内部类和外部模块等的引用
<ul><li>发现它的方式同内存溢出，可再加个实时观察</li> <li>jstat -gcutil 7362 2500 70</li></ul></li></ul> <p>重点关注：</p> <ul><li>FGC — 从应用程序启动到采样时发生 Full GC 的次数。</li> <li>FGCT — 从应用程序启动到采样时 Full GC 所用的时间（单位秒）。</li> <li>FGC 次数越多，FGCT 所需时间越多-可非常有可能存在内存泄漏。</li></ul> <h5 id="解决方案"><a href="#解决方案" class="header-anchor">#</a> 解决方案</h5> <p>（1）检查程序，看是否有死循环或不必要地重复创建大量对象。有则改之。</p> <p>下面是一个重复创建内存的示例：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> OOM <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Integer</span> sum1<span class="token operator">=</span><span class="token number">300000</span><span class="token punctuation">;</span>
        <span class="token class-name">Integer</span> sum2<span class="token operator">=</span><span class="token number">400000</span><span class="token punctuation">;</span>
        <span class="token class-name">OOM</span> oom <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">OOM</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;往ArrayList中加入30w内容&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        oom<span class="token punctuation">.</span><span class="token function">javaHeapSpace</span><span class="token punctuation">(</span>sum1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        oom<span class="token punctuation">.</span><span class="token function">memoryTotal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;往ArrayList中加入40w内容&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        oom<span class="token punctuation">.</span><span class="token function">javaHeapSpace</span><span class="token punctuation">(</span>sum2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        oom<span class="token punctuation">.</span><span class="token function">memoryTotal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">javaHeapSpace</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> sum<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">Random</span> random <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ArrayList</span> openList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>sum<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token class-name">String</span> charOrNum <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>random<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            openList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>charOrNum<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">memoryTotal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">Runtime</span> run <span class="token operator">=</span> <span class="token class-name">Runtime</span><span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">long</span> max <span class="token operator">=</span> run<span class="token punctuation">.</span><span class="token function">maxMemory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">long</span> total <span class="token operator">=</span> run<span class="token punctuation">.</span><span class="token function">totalMemory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">long</span> free <span class="token operator">=</span> run<span class="token punctuation">.</span><span class="token function">freeMemory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">long</span> usable <span class="token operator">=</span> max <span class="token operator">-</span> total <span class="token operator">+</span> free<span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;最大内存 = &quot;</span> <span class="token operator">+</span> max<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;已分配内存 = &quot;</span> <span class="token operator">+</span> total<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;已分配内存中的剩余空间 = &quot;</span> <span class="token operator">+</span> free<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;最大可用内存 = &quot;</span> <span class="token operator">+</span> usable<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>执行结果：</p> <div class="language-java extra-class"><pre class="language-java"><code>往<span class="token class-name">ArrayList</span>中加入<span class="token number">30</span>w内容
最大内存 <span class="token operator">=</span> <span class="token number">20447232</span>
已分配内存 <span class="token operator">=</span> <span class="token number">20447232</span>
已分配内存中的剩余空间 <span class="token operator">=</span> <span class="token number">4032576</span>
最大可用内存 <span class="token operator">=</span> <span class="token number">4032576</span>
往<span class="token class-name">ArrayList</span>中加入<span class="token number">40</span>w内容
<span class="token class-name">Exception</span> in thread <span class="token string">&quot;main&quot;</span> java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span><span class="token class-name">OutOfMemoryError</span><span class="token operator">:</span> <span class="token class-name">Java</span> heap space
    at java<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">copyOf</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">2245</span><span class="token punctuation">)</span>
    at java<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">copyOf</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">2219</span><span class="token punctuation">)</span>
    at java<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token class-name">ArrayList</span><span class="token punctuation">.</span><span class="token function">grow</span><span class="token punctuation">(</span><span class="token class-name">ArrayList</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">242</span><span class="token punctuation">)</span>
    at java<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token class-name">ArrayList</span><span class="token punctuation">.</span><span class="token function">ensureExplicitCapacity</span><span class="token punctuation">(</span><span class="token class-name">ArrayList</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">216</span><span class="token punctuation">)</span>
    at java<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token class-name">ArrayList</span><span class="token punctuation">.</span><span class="token function">ensureCapacityInternal</span><span class="token punctuation">(</span><span class="token class-name">ArrayList</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">208</span><span class="token punctuation">)</span>
    at java<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token class-name">ArrayList</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">ArrayList</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">440</span><span class="token punctuation">)</span>
    at pers<span class="token punctuation">.</span>qingqian<span class="token punctuation">.</span>study<span class="token punctuation">.</span>seven<span class="token punctuation">.</span>OOM<span class="token punctuation">.</span><span class="token function">javaHeapSpace</span><span class="token punctuation">(</span>OOM<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">36</span><span class="token punctuation">)</span>
    at pers<span class="token punctuation">.</span>qingqian<span class="token punctuation">.</span>study<span class="token punctuation">.</span>seven<span class="token punctuation">.</span>OOM<span class="token punctuation">.</span><span class="token function">main</span><span class="token punctuation">(</span>OOM<span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">26</span><span class="token punctuation">)</span>
</code></pre></div><p>（2）扩大堆内存空间</p> <p>使用 <code>-Xms</code> 和 <code>-Xmx</code> 来控制堆内存空间大小。</p> <h4 id="outofmemoryerror-gc-overhead-limit-exceeded"><a href="#outofmemoryerror-gc-overhead-limit-exceeded" class="header-anchor">#</a> OutOfMemoryError: GC overhead limit exceeded</h4> <p>原因：JDK6 新增错误类型，当 GC 为释放很小空间占用大量时间时抛出；一般是因为堆太小，导致异常的原因，没有足够的内存。</p> <p>解决方案：</p> <p>查看系统是否有使用大内存的代码或死循环；
通过添加 JVM 配置，来限制使用内存：</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>jvm-arg</span><span class="token punctuation">&gt;</span></span>-XX:-UseGCOverheadLimit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>jvm-arg</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h4 id="outofmemoryerror：unable-to-create-new-native-thread"><a href="#outofmemoryerror：unable-to-create-new-native-thread" class="header-anchor">#</a> OutOfMemoryError：unable to create new native thread</h4> <p>原因：线程过多</p> <p>那么能创建多少线程呢？这里有一个公式：</p> <div class="language- extra-class"><pre class="language-text"><code>(MaxProcessMemory - JVMMemory - ReservedOsMemory) / (ThreadStackSize) = Number of threads
MaxProcessMemory 指的是一个进程的最大内存
JVMMemory         JVM内存
ReservedOsMemory  保留的操作系统内存
ThreadStackSize      线程栈的大小
</code></pre></div><p>当发起一个线程的创建时，虚拟机会在 JVM 内存创建一个 Thread 对象同时创建一个操作系统线程，而这个系统线程的内存用的不是 JVMMemory，而是系统中剩下的内存：
(MaxProcessMemory - JVMMemory - ReservedOsMemory)
结论：你给 JVM 内存越多，那么你能用来创建的系统线程的内存就会越少，越容易发生 java.lang.OutOfMemoryError: unable to create new native thread。</p> <h4 id="cpu-过高"><a href="#cpu-过高" class="header-anchor">#</a> CPU 过高</h4> <p>定位步骤：</p> <p>（1）执行 top -c 命令，找到 cpu 最高的进程的 id</p> <p>（2）jstack PID 导出 Java 应用程序的线程堆栈信息。</p> <p>示例：</p> <div class="language-java extra-class"><pre class="language-java"><code>jstack <span class="token number">6795</span>

<span class="token string">&quot;Low Memory Detector&quot;</span> daemon prio<span class="token operator">=</span><span class="token number">10</span> tid<span class="token operator">=</span><span class="token number">0x081465f8</span> nid<span class="token operator">=</span><span class="token number">0x7</span> runnable <span class="token punctuation">[</span><span class="token number">0x00000000</span><span class="token punctuation">.</span><span class="token number">.0</span>x00000000<span class="token punctuation">]</span>
        <span class="token string">&quot;CompilerThread0&quot;</span> daemon prio<span class="token operator">=</span><span class="token number">10</span> tid<span class="token operator">=</span><span class="token number">0x08143c58</span> nid<span class="token operator">=</span><span class="token number">0x6</span> waiting on condition <span class="token punctuation">[</span><span class="token number">0x00000000</span><span class="token punctuation">.</span><span class="token number">.0</span>xfb5fd798<span class="token punctuation">]</span>
        <span class="token string">&quot;Signal Dispatcher&quot;</span> daemon prio<span class="token operator">=</span><span class="token number">10</span> tid<span class="token operator">=</span><span class="token number">0x08142f08</span> nid<span class="token operator">=</span><span class="token number">0x5</span> waiting on condition <span class="token punctuation">[</span><span class="token number">0x00000000</span><span class="token punctuation">.</span><span class="token number">.0</span>x00000000<span class="token punctuation">]</span>
        <span class="token string">&quot;Finalizer&quot;</span> daemon prio<span class="token operator">=</span><span class="token number">10</span> tid<span class="token operator">=</span><span class="token number">0x08137ca0</span> nid<span class="token operator">=</span><span class="token number">0x4</span> in <span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token number">0xfbeed000</span><span class="token punctuation">.</span><span class="token number">.0</span>xfbeeddb8<span class="token punctuation">]</span>

        at java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span><span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token class-name">Native</span> <span class="token class-name">Method</span><span class="token punctuation">)</span>

        <span class="token operator">-</span> waiting on <span class="token generics"><span class="token punctuation">&lt;</span>0xef600848<span class="token punctuation">&gt;</span></span> <span class="token punctuation">(</span>a java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>ref<span class="token punctuation">.</span><span class="token class-name">ReferenceQueue</span>$<span class="token class-name">Lock</span><span class="token punctuation">)</span>

        at java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>ref<span class="token punctuation">.</span><span class="token class-name">ReferenceQueue</span><span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token class-name">ReferenceQueue</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">116</span><span class="token punctuation">)</span>

        <span class="token operator">-</span> locked <span class="token generics"><span class="token punctuation">&lt;</span>0xef600848<span class="token punctuation">&gt;</span></span> <span class="token punctuation">(</span>a java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>ref<span class="token punctuation">.</span><span class="token class-name">ReferenceQueue</span>$<span class="token class-name">Lock</span><span class="token punctuation">)</span>

        at java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>ref<span class="token punctuation">.</span><span class="token class-name">ReferenceQueue</span><span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token class-name">ReferenceQueue</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">132</span><span class="token punctuation">)</span>

        at java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>ref<span class="token punctuation">.</span><span class="token class-name">Finalizer</span>$<span class="token class-name">FinalizerThread</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">Finalizer</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">159</span><span class="token punctuation">)</span>

        <span class="token string">&quot;Reference Handler&quot;</span> daemon prio<span class="token operator">=</span><span class="token number">10</span> tid<span class="token operator">=</span><span class="token number">0x081370f0</span> nid<span class="token operator">=</span><span class="token number">0x3</span> in <span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token number">0xfbf4a000</span><span class="token punctuation">.</span><span class="token number">.0</span>xfbf4aa38<span class="token punctuation">]</span>

        at java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span><span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token class-name">Native</span> <span class="token class-name">Method</span><span class="token punctuation">)</span>

        <span class="token operator">-</span> waiting on <span class="token generics"><span class="token punctuation">&lt;</span>0xef600758<span class="token punctuation">&gt;</span></span> <span class="token punctuation">(</span>a java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>ref<span class="token punctuation">.</span><span class="token class-name">Reference</span>$<span class="token class-name">Lock</span><span class="token punctuation">)</span>

        at java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span><span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">474</span><span class="token punctuation">)</span>

        at java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>ref<span class="token punctuation">.</span><span class="token class-name">Reference</span>$<span class="token class-name">ReferenceHandler</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">Reference</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">116</span><span class="token punctuation">)</span>

        <span class="token operator">-</span> locked <span class="token generics"><span class="token punctuation">&lt;</span>0xef600758<span class="token punctuation">&gt;</span></span> <span class="token punctuation">(</span>a java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>ref<span class="token punctuation">.</span><span class="token class-name">Reference</span>$<span class="token class-name">Lock</span><span class="token punctuation">)</span>

        <span class="token string">&quot;VM Thread&quot;</span> prio<span class="token operator">=</span><span class="token number">10</span> tid<span class="token operator">=</span><span class="token number">0x08134878</span> nid<span class="token operator">=</span><span class="token number">0x2</span> runnable

        <span class="token string">&quot;VM Periodic Task Thread&quot;</span> prio<span class="token operator">=</span><span class="token number">10</span> tid<span class="token operator">=</span><span class="token number">0x08147768</span> nid<span class="token operator">=</span><span class="token number">0x8</span> waiting on condition
</code></pre></div><p>在打印的堆栈日志文件中，tid 和 nid 的含义：</p> <div class="language- extra-class"><pre class="language-text"><code>nid : 对应的 Linux 操作系统下的 tid 线程号，也就是前面转化的 16 进制数字
tid: 这个应该是 jvm 的 jmm 内存规范中的唯一地址定位
</code></pre></div><p>在 CPU 过高的情况下，查找响应的线程，一般定位都是用 nid 来定位的。而如果发生死锁之类的问题，一般用 tid 来定位。</p> <p>（3）定位 CPU 高的线程打印其 nid</p> <p>查看线程下具体进程信息的命令如下：</p> <p>top -H -p 6735</p> <div class="language-java extra-class"><pre class="language-java"><code>top <span class="token operator">-</span> <span class="token number">14</span><span class="token operator">:</span><span class="token number">20</span><span class="token operator">:</span><span class="token number">09</span> up <span class="token number">611</span> days<span class="token punctuation">,</span>  <span class="token number">2</span><span class="token operator">:</span><span class="token number">56</span><span class="token punctuation">,</span>  <span class="token number">1</span> user<span class="token punctuation">,</span>  load average<span class="token operator">:</span> <span class="token number">13.19</span><span class="token punctuation">,</span> <span class="token number">7.76</span><span class="token punctuation">,</span> <span class="token number">7.82</span>
<span class="token class-name">Threads</span><span class="token operator">:</span> <span class="token number">6991</span> total<span class="token punctuation">,</span>  <span class="token number">17</span> running<span class="token punctuation">,</span> <span class="token number">6974</span> sleeping<span class="token punctuation">,</span>   <span class="token number">0</span> stopped<span class="token punctuation">,</span>   <span class="token number">0</span> zombie
<span class="token operator">%</span><span class="token class-name">Cpu</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token number">90.4</span> us<span class="token punctuation">,</span>  <span class="token number">2.1</span> sy<span class="token punctuation">,</span>  <span class="token number">0.0</span> ni<span class="token punctuation">,</span>  <span class="token number">7.0</span> id<span class="token punctuation">,</span>  <span class="token number">0.0</span> wa<span class="token punctuation">,</span>  <span class="token number">0.0</span> hi<span class="token punctuation">,</span>  <span class="token number">0.4</span> si<span class="token punctuation">,</span>  <span class="token number">0.0</span> st
<span class="token class-name">KiB</span> <span class="token class-name">Mem</span><span class="token operator">:</span>  <span class="token number">32783044</span> total<span class="token punctuation">,</span> <span class="token number">32505008</span> used<span class="token punctuation">,</span>   <span class="token number">278036</span> free<span class="token punctuation">,</span>   <span class="token number">120304</span> buffers
<span class="token class-name">KiB</span> <span class="token class-name">Swap</span><span class="token operator">:</span>        <span class="token number">0</span> total<span class="token punctuation">,</span>        <span class="token number">0</span> used<span class="token punctuation">,</span>        <span class="token number">0</span> free<span class="token punctuation">.</span> <span class="token number">4497428</span> cached <span class="token class-name">Mem</span>

  PID USER      PR  NI    VIRT    RES    SHR <span class="token class-name">S</span> <span class="token operator">%</span>CPU <span class="token operator">%</span>MEM     TIME<span class="token operator">+</span> COMMAND
 <span class="token number">6800</span> root      <span class="token number">20</span>   <span class="token number">0</span> <span class="token number">27.299</span>g <span class="token number">0.021</span>t   <span class="token number">7172</span> <span class="token class-name">S</span> <span class="token number">54.7</span> <span class="token number">70.1</span> <span class="token number">187</span><span class="token operator">:</span><span class="token number">55.61</span> java
 <span class="token number">6803</span> root      <span class="token number">20</span>   <span class="token number">0</span> <span class="token number">27.299</span>g <span class="token number">0.021</span>t   <span class="token number">7172</span> <span class="token class-name">S</span> <span class="token number">54.4</span> <span class="token number">70.1</span> <span class="token number">187</span><span class="token operator">:</span><span class="token number">52.59</span> java
 <span class="token number">6798</span> root      <span class="token number">20</span>   <span class="token number">0</span> <span class="token number">27.299</span>g <span class="token number">0.021</span>t   <span class="token number">7172</span> <span class="token class-name">S</span> <span class="token number">53.7</span> <span class="token number">70.1</span> <span class="token number">187</span><span class="token operator">:</span><span class="token number">55.08</span> java
 <span class="token number">6801</span> root      <span class="token number">20</span>   <span class="token number">0</span> <span class="token number">27.299</span>g <span class="token number">0.021</span>t   <span class="token number">7172</span> <span class="token class-name">S</span> <span class="token number">53.7</span> <span class="token number">70.1</span> <span class="token number">187</span><span class="token operator">:</span><span class="token number">55.25</span> java
 <span class="token number">6797</span> root      <span class="token number">20</span>   <span class="token number">0</span> <span class="token number">27.299</span>g <span class="token number">0.021</span>t   <span class="token number">7172</span> <span class="token class-name">S</span> <span class="token number">53.1</span> <span class="token number">70.1</span> <span class="token number">187</span><span class="token operator">:</span><span class="token number">52.78</span> java
 <span class="token number">6804</span> root      <span class="token number">20</span>   <span class="token number">0</span> <span class="token number">27.299</span>g <span class="token number">0.021</span>t   <span class="token number">7172</span> <span class="token class-name">S</span> <span class="token number">53.1</span> <span class="token number">70.1</span> <span class="token number">187</span><span class="token operator">:</span><span class="token number">55.76</span> java
 <span class="token number">6802</span> root      <span class="token number">20</span>   <span class="token number">0</span> <span class="token number">27.299</span>g <span class="token number">0.021</span>t   <span class="token number">7172</span> <span class="token class-name">S</span> <span class="token number">52.1</span> <span class="token number">70.1</span> <span class="token number">187</span><span class="token operator">:</span><span class="token number">54.79</span> java
 <span class="token number">6799</span> root      <span class="token number">20</span>   <span class="token number">0</span> <span class="token number">27.299</span>g <span class="token number">0.021</span>t   <span class="token number">7172</span> <span class="token class-name">S</span> <span class="token number">51.8</span> <span class="token number">70.1</span> <span class="token number">187</span><span class="token operator">:</span><span class="token number">53.36</span> java
 <span class="token number">6807</span> root      <span class="token number">20</span>   <span class="token number">0</span> <span class="token number">27.299</span>g <span class="token number">0.021</span>t   <span class="token number">7172</span> <span class="token class-name">S</span> <span class="token number">13.6</span> <span class="token number">70.1</span>  <span class="token number">48</span><span class="token operator">:</span><span class="token number">58.60</span> java
<span class="token number">11014</span> root      <span class="token number">20</span>   <span class="token number">0</span> <span class="token number">27.299</span>g <span class="token number">0.021</span>t   <span class="token number">7172</span> <span class="token class-name">R</span>  <span class="token number">8.4</span> <span class="token number">70.1</span>   <span class="token number">8</span><span class="token operator">:</span><span class="token number">00.32</span> java
<span class="token number">10642</span> root      <span class="token number">20</span>   <span class="token number">0</span> <span class="token number">27.299</span>g <span class="token number">0.021</span>t   <span class="token number">7172</span> <span class="token class-name">R</span>  <span class="token number">6.5</span> <span class="token number">70.1</span>   <span class="token number">6</span><span class="token operator">:</span><span class="token number">32.06</span> java
 <span class="token number">6808</span> root      <span class="token number">20</span>   <span class="token number">0</span> <span class="token number">27.299</span>g <span class="token number">0.021</span>t   <span class="token number">7172</span> <span class="token class-name">S</span>  <span class="token number">6.1</span> <span class="token number">70.1</span> <span class="token number">159</span><span class="token operator">:</span><span class="token number">08.40</span> java
<span class="token number">11315</span> root      <span class="token number">20</span>   <span class="token number">0</span> <span class="token number">27.299</span>g <span class="token number">0.021</span>t   <span class="token number">7172</span> <span class="token class-name">S</span>  <span class="token number">3.9</span> <span class="token number">70.1</span>   <span class="token number">5</span><span class="token operator">:</span><span class="token number">54.10</span> java
<span class="token number">12545</span> root      <span class="token number">20</span>   <span class="token number">0</span> <span class="token number">27.299</span>g <span class="token number">0.021</span>t   <span class="token number">7172</span> <span class="token class-name">S</span>  <span class="token number">3.9</span> <span class="token number">70.1</span>   <span class="token number">6</span><span class="token operator">:</span><span class="token number">55.48</span> java
<span class="token number">23353</span> root      <span class="token number">20</span>   <span class="token number">0</span> <span class="token number">27.299</span>g <span class="token number">0.021</span>t   <span class="token number">7172</span> <span class="token class-name">S</span>  <span class="token number">3.9</span> <span class="token number">70.1</span>   <span class="token number">2</span><span class="token operator">:</span><span class="token number">20.55</span> java
<span class="token number">24868</span> root      <span class="token number">20</span>   <span class="token number">0</span> <span class="token number">27.299</span>g <span class="token number">0.021</span>t   <span class="token number">7172</span> <span class="token class-name">S</span>  <span class="token number">3.9</span> <span class="token number">70.1</span>   <span class="token number">2</span><span class="token operator">:</span><span class="token number">12.46</span> java
 <span class="token number">9146</span> root      <span class="token number">20</span>   <span class="token number">0</span> <span class="token number">27.299</span>g <span class="token number">0.021</span>t   <span class="token number">7172</span> <span class="token class-name">S</span>  <span class="token number">3.6</span> <span class="token number">70.1</span>   <span class="token number">7</span><span class="token operator">:</span><span class="token number">42.72</span> java
</code></pre></div><p>由此可以看出占用 CPU 较高的线程，但是这些还不高，无法直接定位到具体的类。nid 是 16 进制的，所以我们要获取线程的 16 进制 ID：</p> <div class="language- extra-class"><pre class="language-text"><code>printf &quot;%x\n&quot; 6800
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>输出结果:45cd
</code></pre></div><p>然后根据输出结果到 jstack 打印的堆栈日志中查定位：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token string">&quot;catalina-exec-5692&quot;</span> daemon prio<span class="token operator">=</span><span class="token number">10</span> tid<span class="token operator">=</span><span class="token number">0x00007f3b05013800</span> nid<span class="token operator">=</span><span class="token number">0x45cd</span> waiting on condition <span class="token punctuation">[</span><span class="token number">0x00007f3ae08e3000</span><span class="token punctuation">]</span>
   java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token class-name">State</span><span class="token operator">:</span> TIMED_WAITING <span class="token punctuation">(</span>parking<span class="token punctuation">)</span>
        at sun<span class="token punctuation">.</span>misc<span class="token punctuation">.</span><span class="token class-name">Unsafe</span><span class="token punctuation">.</span><span class="token function">park</span><span class="token punctuation">(</span><span class="token class-name">Native</span> <span class="token class-name">Method</span><span class="token punctuation">)</span>
        <span class="token operator">-</span> parking <span class="token keyword">to</span> wait <span class="token keyword">for</span>  <span class="token generics"><span class="token punctuation">&lt;</span>0x00000006a7800598<span class="token punctuation">&gt;</span></span> <span class="token punctuation">(</span>a java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>locks<span class="token punctuation">.</span><span class="token class-name">AbstractQueuedSynchronizer</span>$<span class="token class-name">ConditionObject</span><span class="token punctuation">)</span>
        at java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>locks<span class="token punctuation">.</span><span class="token class-name">LockSupport</span><span class="token punctuation">.</span><span class="token function">parkNanos</span><span class="token punctuation">(</span><span class="token class-name">LockSupport</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">226</span><span class="token punctuation">)</span>
        at java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span>locks<span class="token punctuation">.</span><span class="token class-name">AbstractQueuedSynchronizer</span>$<span class="token class-name">ConditionObject</span><span class="token punctuation">.</span><span class="token function">awaitNanos</span><span class="token punctuation">(</span><span class="token class-name">AbstractQueuedSynchronizer</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">2082</span><span class="token punctuation">)</span>
        at java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span><span class="token class-name">LinkedBlockingQueue</span><span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token class-name">LinkedBlockingQueue</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">467</span><span class="token punctuation">)</span>
        at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>tomcat<span class="token punctuation">.</span>util<span class="token punctuation">.</span>threads<span class="token punctuation">.</span><span class="token class-name">TaskQueue</span><span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token class-name">TaskQueue</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">86</span><span class="token punctuation">)</span>
        at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>tomcat<span class="token punctuation">.</span>util<span class="token punctuation">.</span>threads<span class="token punctuation">.</span><span class="token class-name">TaskQueue</span><span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token class-name">TaskQueue</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">32</span><span class="token punctuation">)</span>
        at java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span><span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">.</span><span class="token function">getTask</span><span class="token punctuation">(</span><span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">1068</span><span class="token punctuation">)</span>
        at java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span><span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">.</span><span class="token function">runWorker</span><span class="token punctuation">(</span><span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">1130</span><span class="token punctuation">)</span>
        at java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span><span class="token class-name">ThreadPoolExecutor</span>$<span class="token class-name">Worker</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">615</span><span class="token punctuation">)</span>
        at org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>tomcat<span class="token punctuation">.</span>util<span class="token punctuation">.</span>threads<span class="token punctuation">.</span><span class="token class-name">TaskThread</span>$<span class="token class-name">WrappingRunnable</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">TaskThread</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">61</span><span class="token punctuation">)</span>
        at java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">745</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="参考资料"><a href="#参考资料" class="header-anchor">#</a> 参考资料</h2> <ul><li><a href="https://item.jd.com/11252778.html" target="_blank" rel="noopener noreferrer">《深入理解 Java 虚拟机》<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://www.douban.com/doulist/2545443/" target="_blank" rel="noopener noreferrer">从表到里学习 JVM 实现<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="http://www.importnew.com/23761.html" target="_blank" rel="noopener noreferrer">JVM（4）：Jvm 调优-命令篇<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://www.cnblogs.com/zhguang/p/Java-JVM-GC.html" target="_blank" rel="noopener noreferrer">Java系列笔记(4) - JVM 监控与调优<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://segmentfault.com/a/1190000005174819" target="_blank" rel="noopener noreferrer">Java服务 GC 参数调优案例<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="http://www.importnew.com/19264.html" target="_blank" rel="noopener noreferrer">JVM 调优总结（5）：典型配置<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://juejin.im/post/59f02f406fb9a0451869f01c" target="_blank" rel="noopener noreferrer">如何合理的规划一次 jvm 性能调优<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="http://www.ityouknow.com/jvm/2017/09/21/How-to-optimize-Java-GC.html" target="_blank" rel="noopener noreferrer">jvm 系列(九):如何优化 Java GC「译」<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://www.jianshu.com/p/28935cbfbae0" target="_blank" rel="noopener noreferrer">作为测试你应该知道的 JAVA OOM 及定位分析<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://blog.csdn.net/sinat_29912455/article/details/51125748" target="_blank" rel="noopener noreferrer">异常、堆内存溢出、OOM 的几种情况<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>https://my.oschina.net/feichexia/blog/196575</li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/dunwu/javacore/edit/master/docs/jvm/jvm-action.md" target="_blank" rel="noopener noreferrer">帮助我们改善此页面！</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <!----> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/javacore/assets/js/app.3de50782.js" defer></script><script src="/javacore/assets/js/4.13456b84.js" defer></script><script src="/javacore/assets/js/54.5410b72b.js" defer></script><script src="/javacore/assets/js/5.65836544.js" defer></script>
  </body>
</html>
